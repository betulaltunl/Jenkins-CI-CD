<h1 id="center">Jenkins Dokümanı</h1>
<h1 id="bölüm-1">BÖLÜM-1</h1>
<h2 id="içindekiler">İÇİNDEKİLER:</h2>
<h3 id="jenkins-kurulumu"><strong>1. Jenkins Kurulumu</strong></h3>
<h3 id="java-kurulumu"><strong>2. Java Kurulumu</strong></h3>
<h3 id="jenkins-servisini-yönetme"><strong>3. Jenkins Servisini
Yönetme</strong></h3>
<h3 id="nginx-kurulumu-ve-yapılandırması-reverse-proxy"><strong>4. Nginx
Kurulumu ve Yapılandırması (Reverse Proxy)</strong></h3>
<h3 id="self-signed-sertifika-oluşturma-https-için"><strong>5.
Self-Signed Sertifika Oluşturma (HTTPS için)</strong></h3>
<h3 id="nginx-yapılandırmasını-https-için-güncelleme"><strong>6. Nginx
Yapılandırmasını HTTPS için Güncelleme</strong></h3>
<h3 id="jenkinse-erişme"><strong>7. Jenkins’e Erişme</strong></h3>
<h3 id="ek-bilgiler-plugin-folder-artifact-workspace"><strong>8. Ek
Bilgiler; Plugin, Folder, Artifact, Workspace</strong></h3>
<hr />
<p><strong>1. Jenkins Kurulumu</strong></p>
<ul>
<li><strong>Jenkins Hakkında Bilgi (Opsiyonel):</strong></li>
</ul>
<div class="sourceCode" id="cb1"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="ex">apt-cache</span> show jenkins</span></code></pre></div>
<p>Bu komut, Jenkins paketi hakkında bilgi verir (versiyon,
bağımlılıklar, açıklama vb.). Kuruluma başlamadan önce Jenkins hakkında
bilgi edinmek için faydalıdır.</p>
<ul>
<li><strong>Jenkins Repository Ekleme:</strong></li>
</ul>
<div class="sourceCode" id="cb2"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> wget <span class="at">-O</span> /usr/share/keyrings/jenkins-keyring.asc https://pkg.jenkins.io/debian-stable/jenkins.io-2023.key</span></code></pre></div>
<div class="sourceCode" id="cb3"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;deb [signed-by=/usr/share/keyrings/jenkins-keyring.asc] https://pkg.jenkins.io/debian-stable binary/&quot;</span> <span class="kw">|</span> <span class="fu">sudo</span> tee /etc/apt/sources.list.d/jenkins.list <span class="op">&gt;</span> /dev/null</span></code></pre></div>
<p>Bu adımlar, Jenkins’in resmi paket deposunu sisteminize ekler. Bu
sayede, Jenkins’i apt paket yöneticisi ile kurabileceksiniz.</p>
<ul>
<li><strong>Paket Listesini Güncelleme:</strong></li>
</ul>
<div class="sourceCode" id="cb4"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> apt-get update</span></code></pre></div>
<p>Bu komut, sistemdeki paket listesini günceller. Yeni eklenen Jenkins
deposunun da listeye dahil olmasını sağlar.</p>
<ul>
<li><strong>Jenkins Kurulumu:</strong></li>
</ul>
<div class="sourceCode" id="cb5"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> apt-get install jenkins</span></code></pre></div>
<p>Bu komut, Jenkins’i kurar. Kurulum sırasında bağımlılıklar da
otomatik olarak kurulacaktır.</p>
<p><strong>2. Java Kurulumu</strong></p>
<p>Jenkins Java ile çalıştığı için, sisteminizde Java’nın kurulu olması
gerekir.</p>
<ul>
<li><strong>Paket Listesini Güncelleme (Tekrar):</strong></li>
</ul>
<div class="sourceCode" id="cb6"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> apt update</span></code></pre></div>
<p>Paket listesini tekrar güncellemek her zaman iyi bir uygulamadır.</p>
<ul>
<li><p><strong>Java Kurulumu (OpenJDK 17):</strong></p>
<div class="sourceCode" id="cb7"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> apt install fontconfig openjdk-17-jre</span></code></pre></div>
<p>Bu komut, OpenJDK 17’nin Java Runtime Environment (JRE) sürümünü
kurar.  fontconfig, Java uygulamalarının yazı tiplerini doğru şekilde
işlemesi için gereklidir. Farklı bir Java sürümü kullanmak
isterseniz, openjdk-17-jre yerine istediğiniz sürümü belirtebilirsiniz
(örneğin, openjdk-11-jre).</p></li>
<li><p><strong>Java Versiyonunu Kontrol Etme:</strong></p>
<div class="sourceCode" id="cb8"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="ex">java</span> <span class="at">-version</span></span></code></pre></div>
<p>Doğru sürümün kurulu olduğunu doğrulamak için önemlidir.</p></li>
</ul>
<p><strong>3. Jenkins Servisini Yönetme</strong></p>
<ul>
<li><p><strong>Jenkins’i Başlatma:</strong></p>
<div class="sourceCode" id="cb9"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> systemctl start jenkins</span></code></pre></div>
<p>Jenkins servisini başlatır.</p></li>
<li><p><strong>Jenkins Servis Durumunu Kontrol Etme:</strong></p>
<div class="sourceCode" id="cb10"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> systemctl status jenkins</span></code></pre></div></li>
<li><p><strong>Jenkins’in Dinlediği Portu Kontrol Etme:</strong></p>
<div class="sourceCode" id="cb11"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> netstat <span class="at">-ntlp</span> <span class="kw">|</span> <span class="fu">grep</span> 8080</span></code></pre></div>
<p>Jenkins genellikle 8080 portunda çalışır. Bu komut, 8080 portunun
Jenkins tarafından kullanıldığını doğrular. Eğer Jenkins farklı bir
portta çalışıyorsa, 8080 yerine o portu kullanın.</p></li>
<li><p><strong>İlk Yönetici Parolasını Alma:</strong></p>
<div class="sourceCode" id="cb12"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> cat /var/lib/jenkins/secrets/initialAdminPassword</span></code></pre></div>
<p>Bu komut, Jenkins kurulumundan sonra oluşturulan ilk yönetici
parolasını gösterir. Bu parolayı, Jenkins’e ilk kez giriş yaparken
kullanacaksınız.</p></li>
</ul>
<p><strong>4. Nginx Kurulumu ve Yapılandırması (Reverse
Proxy)</strong></p>
<p>Nginx’i bir reverse proxy olarak kullanmak, Jenkins’e güvenli ve
kolay bir şekilde erişmenizi sağlar.</p>
<ul>
<li><p><strong>Paket Listesini Güncelleme:</strong></p>
<div class="sourceCode" id="cb13"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> apt update</span></code></pre></div></li>
<li><p><strong>Nginx Kurulumu:</strong></p>
<div class="sourceCode" id="cb14"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> apt install nginx</span></code></pre></div></li>
<li><p><strong>Nginx Servis Durumunu Kontrol Etme:</strong></p>
<div class="sourceCode" id="cb15"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> systemctl status nginx</span></code></pre></div></li>
<li><p><strong>Firewall Ayarları (UFW):</strong></p>
<div class="sourceCode" id="cb16"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> ufw allow <span class="st">&#39;Nginx HTTP&#39;</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> ufw allow <span class="st">&#39;Nginx HTTPS&#39;</span>  <span class="co">#HTTPS için de izin veriyoruz (ileride kullanacağız)</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> ufw enable <span class="co"># ufw&#39;yi etkinleştir</span></span></code></pre></div>
<p>Eğer UFW kullanıyorsanız, Nginx’in trafiğe izin vermesi için bu
komutları çalıştırmanız gerekir.</p></li>
<li><p><strong>Nginx Yapılandırma Dosyası Oluşturma:</strong></p>
<div class="sourceCode" id="cb17"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> nano /etc/nginx/sites-available/jenkins</span></code></pre></div>
<p>Bu komut, jenkins adında yeni bir Nginx yapılandırma dosyası açar.
İçeriği aşağıdaki gibi olmalıdır (alan adınızı/IP adresinizi ve port
numarasını kendi değerlerinizle değiştirin):</p>
<div class="sourceCode" id="cb18"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="ex">server</span> {</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>    <span class="ex">listen</span> 80<span class="kw">;</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>    <span class="ex">server_name</span> example.com<span class="kw">;</span> <span class="co"># Alan adınız veya sunucu IP&#39;niz</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>    <span class="ex">location</span> / {</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>        <span class="ex">proxy_pass</span> http://localhost:8080<span class="kw">;</span> <span class="co"># Jenkins&#39;in çalıştığı adres ve port</span></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>        <span class="ex">proxy_set_header</span> X-Real-IP <span class="va">$remote_addr</span><span class="kw">;</span></span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>        <span class="ex">proxy_set_header</span> X-Forwarded-For <span class="va">$proxy_add_x_forwarded_for</span><span class="kw">;</span></span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>        <span class="ex">proxy_set_header</span> Host <span class="va">$http_host</span><span class="kw">;</span></span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>        <span class="ex">proxy_set_header</span> X-Forwarded-Proto <span class="va">$scheme</span><span class="kw">;</span> <span class="co">#HTTPS için önemli</span></span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>    <span class="er">}</span></span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a><span class="er">}</span></span></code></pre></div>
<p><strong>Açıklama:</strong></p>
<ul>
<li>“listen 80;” Nginx’in 80 portunu dinlemesini sağlar (HTTP).</li>
<li>“server_name example.com;” Alan adınızı veya sunucu IP adresinizi
buraya yazın.</li>
<li>“proxy_pass http://localhost:8080;” Tüm
istekleri localhost:8080 adresine (Jenkins’in çalıştığı adres ve port)
yönlendirir.</li>
<li>“proxy_set_header …” Bu satırlar, istemcinin gerçek IP adresini ve
diğer bilgileri Jenkins’e iletir. Reverse proxy’nin doğru çalışması için
önemlidir.</li>
<li>“X-Forwarded-Proto $scheme” HTTPS kullanıyorsanız, Jenkins’e isteğin
HTTPS üzerinden geldiğini bildirir.</li>
</ul></li>
<li><p><strong>Nginx Yapılandırma Dosyasını Etkinleştirme:</strong></p>
<div class="sourceCode" id="cb19"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> ln <span class="at">-s</span> /etc/nginx/sites-available/jenkins /etc/nginx/sites-enabled/</span></code></pre></div>
<p>Bu komut, jenkins yapılandırma dosyasını sites-enabled dizinine
sembolik link ile ekleyerek etkinleştirir.</p></li>
<li><p><strong>Varsayılan Nginx Yapılandırmasını Devre Dışı Bırakma
(Opsiyonel):</strong></p>
<div class="sourceCode" id="cb20"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> rm /etc/nginx/sites-enabled/default</span></code></pre></div>
<p>Eğer sadece Jenkins’e erişmek istiyorsanız, varsayılan Nginx
yapılandırmasını devre dışı bırakabilirsiniz. Ancak, bu sadece tek bir
web sitesi barındırıyorsanız geçerlidir. Birden fazla web sitesi
barındırıyorsanız, varsayılan yapılandırmayı değiştirmek daha uygun
olabilir.</p></li>
<li><p><strong>Nginx Yapılandırmasını Test Etme:</strong></p>
<div class="sourceCode" id="cb21"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> nginx <span class="at">-t</span></span></code></pre></div>
<p>Bu komut, Nginx yapılandırma dosyalarınızı sözdizimsel olarak test
eder. Hata varsa, hatanın nerede olduğunu gösterir.</p></li>
<li><p><strong>Nginx ve Jenkins’i Yeniden Başlatma:</strong></p>
<div class="sourceCode" id="cb22"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> systemctl restart nginx</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> systemctl restart jenkins</span></code></pre></div>
<p>Yapılandırma değişikliklerinin etkili olması için Nginx ve Jenkins’i
yeniden başlatmanız gerekir.</p></li>
<li><p><strong>Servis Durumlarını Kontrol Etme:</strong></p>
<div class="sourceCode" id="cb23"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> systemctl status nginx</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> systemctl status jenkins</span></code></pre></div></li>
</ul>
<p><strong>5. Self-Signed Sertifika Oluşturma (HTTPS için)</strong></p>
<p>Bu adım, Jenkins’e HTTPS üzerinden erişmek için gereklidir.
Self-signed sertifika, ücretsiz bir seçenektir. Let’s Encrypt gibi bir
sertifika otoriteside kullanılabilir.</p>
<ul>
<li><p><strong>Self-Signed Sertifika Oluşturma:</strong></p>
<div class="sourceCode" id="cb24"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> openssl req <span class="at">-x509</span> <span class="at">-nodes</span> <span class="at">-days</span> 365 <span class="at">-newkey</span> rsa:2048 <span class="at">-keyout</span> /etc/ssl/private/nginx-selfsigned.key <span class="at">-out</span> /etc/ssl/certs/nginx-selfsigned.crt</span></code></pre></div>
<p>Bu komut, 365 gün geçerli bir self-signed sertifika ve özel anahtar
oluşturur. Oluşturma sırasında bazı bilgiler istenecektir (ülke, şehir,
organizasyon adı vb.).</p></li>
<li><p><strong>Sertifika ve Anahtar Dosyalarının Konumunu Kontrol
Etme:</strong></p>
<div class="sourceCode" id="cb25"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ls</span> /etc/ssl/certs</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ls</span> /etc/ssl/private</span></code></pre></div></li>
</ul>
<p><strong>6. Nginx Yapılandırmasını HTTPS için Güncelleme</strong></p>
<ul>
<li><p><strong>Nginx Yapılandırma Dosyasını Düzenleme:</strong></p>
<div class="sourceCode" id="cb26"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> nano /etc/nginx/sites-available/jenkins</span></code></pre></div>
<p>Dosyanın içeriğini aşağıdaki gibi güncelleyin:</p>
<div class="sourceCode" id="cb27"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="ex">server</span> {</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>    <span class="ex">listen</span> 80<span class="kw">;</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>    <span class="ex">server_name</span> example.com<span class="kw">;</span> <span class="co"># Alan adınız veya sunucu IP&#39;niz</span></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="dv">301</span> <span class="ex">https://</span><span class="va">$host$request_uri</span><span class="kw">;</span> <span class="co"># HTTP&#39;den HTTPS&#39;ye yönlendirme</span></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a><span class="er">}</span></span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a><span class="ex">server</span> {</span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>    <span class="ex">listen</span> 443 ssl<span class="kw">;</span></span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>    <span class="ex">server_name</span> example.com<span class="kw">;</span> <span class="co"># Alan adınız veya sunucu IP&#39;niz</span></span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a>    <span class="ex">ssl_certificate</span> /etc/ssl/certs/nginx-selfsigned.crt<span class="kw">;</span></span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a>    <span class="ex">ssl_certificate_key</span> /etc/ssl/private/nginx-selfsigned.key<span class="kw">;</span></span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-14"><a href="#cb27-14" aria-hidden="true" tabindex="-1"></a>    <span class="ex">location</span> / {</span>
<span id="cb27-15"><a href="#cb27-15" aria-hidden="true" tabindex="-1"></a>        <span class="ex">proxy_pass</span> http://localhost:8080<span class="kw">;</span> <span class="co"># Jenkins&#39;in çalıştığı adres ve port</span></span>
<span id="cb27-16"><a href="#cb27-16" aria-hidden="true" tabindex="-1"></a>        <span class="ex">proxy_set_header</span> X-Real-IP <span class="va">$remote_addr</span><span class="kw">;</span></span>
<span id="cb27-17"><a href="#cb27-17" aria-hidden="true" tabindex="-1"></a>        <span class="ex">proxy_set_header</span> X-Forwarded-For <span class="va">$proxy_add_x_forwarded_for</span><span class="kw">;</span></span>
<span id="cb27-18"><a href="#cb27-18" aria-hidden="true" tabindex="-1"></a>        <span class="ex">proxy_set_header</span> Host <span class="va">$http_host</span><span class="kw">;</span></span>
<span id="cb27-19"><a href="#cb27-19" aria-hidden="true" tabindex="-1"></a>        <span class="ex">proxy_set_header</span> X-Forwarded-Proto https<span class="kw">;</span></span>
<span id="cb27-20"><a href="#cb27-20" aria-hidden="true" tabindex="-1"></a>    <span class="er">}</span></span>
<span id="cb27-21"><a href="#cb27-21" aria-hidden="true" tabindex="-1"></a><span class="er">}</span></span></code></pre></div>
<p><strong>Açıklama:</strong></p>
<ul>
<li>İki server bloğu var: Biri HTTP (80 portu) için, diğeri HTTPS (443
portu) için.</li>
<li>HTTP bloğu, tüm istekleri otomatik olarak HTTPS’ye yönlendirir
(return 301 https://<span
class="math inline"><em>h</em><em>o</em><em>s</em><em>t</em></span>request_uri;).</li>
<li>HTTPS bloğu, SSL’i etkinleştirir (listen 443 ssl;) ve sertifika ve
özel anahtar dosyalarının konumlarını belirtir.</li>
<li>X-Forwarded-Proto https;: Jenkins’e isteğin HTTPS üzerinden
geldiğini bildirir.</li>
</ul></li>
<li><p><strong>Nginx Yapılandırmasını Test Etme:</strong></p>
<div class="sourceCode" id="cb28"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> nginx <span class="at">-t</span></span></code></pre></div></li>
<li><p><strong>Nginx’i Yeniden Başlatma:</strong></p>
<div class="sourceCode" id="cb29"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> systemctl restart nginx</span></code></pre></div></li>
<li><p><strong>Firewall’da HTTPS’e İzin Verme (Eğer UFW
Kullanıyorsanız):</strong></p>
<div class="sourceCode" id="cb30"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> ufw allow <span class="st">&#39;Nginx Full&#39;</span> <span class="co">#Hem HTTP hem de HTTPS&#39;e izin verir.</span></span></code></pre></div></li>
</ul>
<p><strong>7. Jenkins’e Erişme</strong></p>
<p>Tarayıcınızda https://example.com (veya sunucu IP adresiniz) adresine
giderek Jenkins’e erişebilirsiniz. Tarayıcınız, self-signed sertifika
nedeniyle bir uyarı gösterebilir. Bu uyarıyı kabul ederek devam
edebilirsiniz.</p>
<p><strong>8. JENKINS</strong></p>
<ul>
<li><p><strong>PLUGIN</strong></p>
<p>Plugin’ler, Jenkins ortamının işlevselliğini kuruluşların veya
kullanıcıların özel ihtiyaçlarına göre geliştirmesini sağlayan
araçlardır. Bir Jenkins denetleyicisine kurulabilen ve çeşitli yapı
araçlarını, bulut sağlayıcılarını, analiz araçlarını ve daha birçok
sistemi entegre edebilen binden fazla farklı plugin bulunmaktadır.</p>
<p>Plugin’ler, bağımlılıklarıyla birlikte Güncelleme Merkezi’nden
otomatik olarak indirilebilir. Güncelleme Merkezi, Jenkins topluluğunun
çeşitli üyeleri tarafından geliştirilen ve sürdürülen açık kaynaklı
plugin’lerin bir listesini sunan, Jenkins projesi tarafından işletilen
bir hizmettir.</p>
<p>Başta ve daha sonrasında indirilen bu pluginler kaldırılabilir.</p>
<ul>
<li><strong>Dikkat Edilmesi Gerekenler:</strong>
<ul>
<li>Bir plugin’i kaldırmadan önce, o plugin’i kullanan herhangi bir job
veya yapılandırma olup olmadığını kontrol edin. Aksi takdirde, kaldırma
işlemi sonrasında bu job’lar veya yapılandırmalar düzgün
çalışmayabilir.</li>
<li>Bazı plugin’ler, diğer plugin’lere bağımlı olabilir. Bir plugin’i
kaldırdığınızda, bağımlı olduğu diğer plugin’lerin de çalışmasını
etkileyebilirsiniz. Bu nedenle, kaldırma işleminden önce bağımlılıkları
kontrol etmek önemlidir.</li>
</ul></li>
</ul></li>
<li><p><strong>FOLDER</strong></p>
<p>Jenkins’te çok sayıda job’unuz olduğunda, bunları yönetmek
zorlaşabilir. İşte bu noktada “Folder” özelliği devreye girer.</p>
<ul>
<li><strong>Klasörlerin Amacı:</strong>
<ul>
<li>Klasörler, job’ları mantıksal gruplar halinde düzenlemenize olanak
tanır. Örneğin, farklı projeler, ortamlar (test, geliştirme, üretim)
veya ekipler için ayrı klasörler oluşturabilirsiniz.</li>
<li>Klasörler, job’ları daha kolay bulmanızı, yönetmenizi ve
yetkilendirmenizi sağlar.</li>
</ul></li>
<li><strong>Klasör Oluşturma:</strong> New Item –&gt; Folder</li>
<li><strong>Klasör İçine Job Ekleme:</strong>
<ul>
<li>Var olan bir job’u bir klasöre taşımak için, job’un yapılandırma
sayfasına gidin ve “Folder” seçeneğini kullanarak job’u istediğiniz
klasöre taşıyın.</li>
<li>Yeni bir job oluştururken, “Folder” seçeneğini kullanarak job’u
doğrudan bir klasörün içinde oluşturabilirsiniz.</li>
</ul></li>
</ul></li>
<li><p><strong>ARTIFACT</strong></p>
<p>Jenkins’te bir build işlemi (job çalıştırma) tamamlandığında, ortaya
çeşitli sonuçlar çıkabilir. Bu sonuçların en önemlilerinden biri
“artifact” olarak adlandırılır.</p>
<ul>
<li><strong>Artifact Nedir?</strong>
<ul>
<li>Artifact, bir build işlemi sonucunda üretilen, dağıtılmaya veya
kullanılmaya hazır olan herhangi bir dosyadır.</li>
<li>Örnek olarak, bir web uygulamasının WAR dosyası, bir Java
uygulamasının JAR dosyası, bir yazılım paketinin kurulum dosyası, test
sonuçları raporları veya dokümantasyon dosyaları birer artifact
olabilir.</li>
<li>Jenkins, artifact’ları otomatik olarak saklayabilir, arşivleyebilir
ve paylaşabilir.</li>
</ul></li>
<li><strong>Artifact’ları Yönetme:</strong>
<ul>
<li>Jenkins’te, her job için artifact’ların saklanacağı bir dizin
belirleyebilirsiniz.</li>
<li>“Post-build Actions” bölümünde, artifact’ları arşivlemek, yayınlamak
veya başka bir yere kopyalamak için çeşitli seçenekler mevcuttur. <img
src="/image/dokuman2_ss/artifact.png" alt="image" /></li>
</ul></li>
</ul></li>
<li><p><strong>WORKSPACE:</strong></p>
<p>/varlib/jenkins/workspace Jenkins’in <strong>varsayılan workspace
dizinidir.</strong> Jenkins, her job için bu dizin altında ayrı bir alt
dizin oluşturur ve job’un tüm verilerini (kaynak kod, build çıktıları,
log dosyaları vb.) bu dizinde saklar.</p>
<ul>
<li><strong>Çalışma Alanının Önemi:</strong>
<ul>
<li>Çalışma alanı, Jenkins’in job’ları çalıştırmak için kullandığı temel
dizindir.</li>
<li>Job’lar, kaynak kodu bu dizine kopyalar, build işlemlerini bu
dizinde gerçekleştirir ve artifact’ları bu dizinde oluşturur.</li>
</ul></li>
<li><strong>Çalışma Alanını Yönetme:</strong>
<ul>
<li>Jenkins’te, her job için özel bir çalışma alanı dizini
belirleyebilirsiniz.</li>
<li>Büyük projelerde, disk alanını verimli kullanmak için çalışma
alanlarını düzenli olarak temizlemek önemlidir.</li>
<li>/var/lib/jenkins/workspace dizinine doğrudan erişmek yerine, Jenkins
arayüzünü veya API’sini kullanarak job’ların verilerine erişmek daha
güvenlidir.</li>
</ul></li>
</ul></li>
</ul>
<hr />
<h1 id="bölüm-2">BÖLÜM-2</h1>
<h2 id="içindekiler-1">İÇİNDEKİLER:</h2>
<h3 id="master-slave-bağlantısı-kurulumu"><strong>1. Master-Slave
Bağlantısı Kurulumu</strong></h3>
<h3 id="manuel-build-alma"><strong>2. Manuel Build Alma</strong></h3>
<h3 id="cron-ile-build-alma"><strong>3. Cron ile Build
Alma</strong></h3>
<h3 id="trigger-ile-build-alma"><strong>4. Trigger ile Build
Alma</strong></h3>
<h3 id="jenkins-user-yönetimi-ve-parametrik-joblar"><strong>5. Jenkins
User Yönetimi ve Parametrik Job’lar</strong></h3>
<hr />
<h2 id="master-slave-bağlantısı-kurulumu-1">Master-Slave Bağlantısı
Kurulumu</h2>
<p>Bu adım, Jenkins’in iş yükünü dağıtmak için ikinci bir sanal makine
(Slave) oluşturulmasını ve Master makine ile bağlantısının
yapılandırılmasını içerir.</p>
<p><strong>Adımlar:</strong></p>
<ol type="1">
<li><p><strong>İkinci Sanal Makine Kurulumu:</strong> Yeni bir sanal
makine oluşturun (Slave).</p></li>
<li><p><strong>Şifresiz SSH Bağlantısı:</strong> Master makineden Slave
makineye şifresiz SSH bağlantısı kurun.</p>
<ul>
<li><p><strong>SSH Anahtarı Oluşturma (Master):</strong></p>
<div class="sourceCode" id="cb31"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ssh-keygen</span> <span class="at">-t</span> rsa <span class="at">-b</span> 4096 <span class="at">-C</span> <span class="st">&quot;jenkins server ssh keys&quot;</span> <span class="at">-f</span> jenkins_id_rsa</span></code></pre></div>
<p>Bu komut, Master makinede jenkins_id_rsa  ve jenkins_id_rsa.pub
dosyalarını oluşturur.</p></li>
<li><p><strong>Private Key’i Jenkins’e
Ekleme:</strong> Oluşturulan jenkins_id_rsa dosyasının içeriğini
Jenkins’in <strong>Credentials</strong> bölümüne ekleyin. Bu, Jenkins’in
SSH bağlantısını yönetmesini sağlar.</p></li>
<li><p><strong>Public Key’i Slave’e Ekleme:</strong></p>
<ul>
<li>Slave makinede root kullanıcısına geçin: sudo su - (veya ilgili
kullanıcı).</li>
<li>.ssh dizini yoksa oluşturun: mkdir -p ~/.ssh</li>
<li>authorized_keys dosyası oluşturun veya varsa düzenleyin: nano
~/.ssh/authorized_keys</li>
<li>Master makinede oluşturulan jenkins_id_rsa.pub dosyasının içeriğini
bu dosyaya yapıştırın.</li>
<li>Dosyanın doğru izinlere sahip olduğundan emin olun: chmod 600
~/.ssh/authorized_keys ve chmod 700 ~/.ssh</li>
</ul></li>
<li><p><strong>SSH Bağlantısını Test Etme:</strong></p>
<div class="sourceCode" id="cb32"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ssh</span> <span class="at">-i</span> ./jenkins_id_rsa root@<span class="op">&lt;</span>slave_ip<span class="op">&gt;</span></span></code></pre></div>
<p>Eğer bağlantı sırasında fingerprint doğrulaması yapılıyorsa kabul
edin.</p></li>
</ul></li>
<li><p><strong>SSH Agent Plugin Kurulumu:</strong> Jenkins’in Slave
makineye erişmesi için <strong>SSH Agent Plugin</strong>’ini
kurun.</p></li>
<li><p><strong>Jenkins Job’u Oluşturma ve Test Etme:</strong> Jenkins
üzerinden yeni bir Job oluşturun ve Slave makinede çalıştığını
doğrulamak için aşağıdaki komutlardan birini çalıştırın:</p>
<div class="sourceCode" id="cb33"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="ex">ip</span> <span class="at">-a</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a><span class="ex">ifconfig</span></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span> /etc/hostname</span></code></pre></div></li>
</ol>
<h2 id="manuel-build-alma-1">1. Manuel Build Alma</h2>
<p><strong>1.Jenkins Job’unu Oluşturun:</strong> </p>
<figure>
<img src="/image/dokuman2_ss/job-olusturma.png" alt="image" />
<figcaption aria-hidden="true">image</figcaption>
</figure>
<p><strong>2.SSH Agent’ı Yapılandırın:</strong></p>
<ul>
<li>Job
yapılandırmasında <strong>Environment</strong> bölümünde <strong>Use ssh
agent</strong> seçeneğini işaretleyin ve önceden oluşturduğunuz
credential’ı seçin.</li>
</ul>
<p><strong>3.Build Adımları Ekleyin:</strong></p>
<ul>
<li><p><strong>Build Steps</strong> bölümünde <strong>Execute
shell</strong> adımı ekleyin.</p></li>
<li><p>Slave makinede çalıştırmak istediğiniz komutu bu alana yazın.
Örneğin:</p>
<div class="sourceCode" id="cb34"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ssh</span> <span class="at">-o</span> <span class="st">&#39;StrictHostKeyChecking=no&#39;</span> root@<span class="op">&lt;</span>slave_ip<span class="op">&gt;</span> <span class="st">&#39;/root/backup.sh&#39;</span></span></code></pre></div></li>
<li><p>StrictHostKeyChecking=no, ilk bağlantıda fingerprint kontrolünü
atlar (güvenlik açığı oluşturabileceğini unutmayın). <img
src="/image/dokuman2_ss/manuel-build-backıp-script.png"
alt="image" /></p></li>
</ul>
<p><strong>4.Backup Script’i Oluşturma (Slave)</strong></p>
<p>Bu adım, Slave makinesinde çalışacak bir yedekleme script’inin
oluşturulmasını içerir.</p>
<p><strong>4.1. /opt/mysql Klasörü Oluşturma:</strong></p>
<div class="sourceCode" id="cb35"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>    <span class="fu">sudo</span> mkdir <span class="at">-p</span> /opt/mysql</span></code></pre></div>
<p><strong>4.2./opt/backup Klasörü Oluşturma:</strong></p>
<div class="sourceCode" id="cb36"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>    <span class="fu">sudo</span> mkdir <span class="at">-p</span> /opt/backups</span></code></pre></div>
<p><strong>4.3.Backup Script’i Oluşturma:</strong> </p>
<p>/opt/backup.sh dosyasını oluşturun ve aşağıdaki içeriği ekleyin:</p>
<div class="sourceCode" id="cb37"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">#!/bin/bash</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>    <span class="va">SOURCE_DIR</span><span class="op">=</span><span class="st">&quot;/opt/mysql&quot;</span></span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>    <span class="va">BACKUP_DIR</span><span class="op">=</span><span class="st">&quot;/opt/backups&quot;</span></span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mkdir</span> <span class="at">-p</span> <span class="st">&quot;</span><span class="va">$BACKUP_DIR</span><span class="st">&quot;</span></span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a>    <span class="va">TIMESTAMP</span><span class="op">=</span><span class="va">$(</span><span class="fu">date</span> +<span class="st">&quot;%Y%m%d_%H%M%S&quot;</span><span class="va">)</span></span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a>    <span class="va">BACKUP_FILENAME</span><span class="op">=</span><span class="st">&quot;backup_</span><span class="va">$(</span><span class="fu">basename</span> <span class="st">&quot;</span><span class="va">$SOURCE_DIR</span><span class="st">&quot;</span><span class="va">)</span><span class="st">_</span><span class="va">$TIMESTAMP</span><span class="st">.tar.gz&quot;</span></span>
<span id="cb37-10"><a href="#cb37-10" aria-hidden="true" tabindex="-1"></a>    <span class="va">BACKUP_PATH</span><span class="op">=</span><span class="st">&quot;</span><span class="va">$BACKUP_DIR</span><span class="st">/</span><span class="va">$BACKUP_FILENAME</span><span class="st">&quot;</span></span>
<span id="cb37-11"><a href="#cb37-11" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb37-12"><a href="#cb37-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="fu">tar</span> <span class="at">-czf</span> <span class="st">&quot;</span><span class="va">$BACKUP_PATH</span><span class="st">&quot;</span> <span class="at">-C</span> <span class="st">&quot;</span><span class="va">$(</span><span class="fu">dirname</span> <span class="st">&quot;</span><span class="va">$SOURCE_DIR</span><span class="st">&quot;</span><span class="va">)</span><span class="st">&quot;</span> <span class="st">&quot;</span><span class="va">$(</span><span class="fu">basename</span> <span class="st">&quot;</span><span class="va">$SOURCE_DIR</span><span class="st">&quot;</span><span class="va">)</span><span class="st">&quot;</span><span class="kw">;</span> <span class="cf">then</span></span>
<span id="cb37-13"><a href="#cb37-13" aria-hidden="true" tabindex="-1"></a>        <span class="bu">echo</span> <span class="st">&quot;Backup successful: </span><span class="va">$BACKUP_PATH</span><span class="st">&quot;</span></span>
<span id="cb37-14"><a href="#cb37-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span></span>
<span id="cb37-15"><a href="#cb37-15" aria-hidden="true" tabindex="-1"></a>        <span class="bu">echo</span> <span class="st">&quot;Backup failed!&quot;</span></span>
<span id="cb37-16"><a href="#cb37-16" aria-hidden="true" tabindex="-1"></a>        <span class="bu">exit</span> 1</span>
<span id="cb37-17"><a href="#cb37-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">fi</span></span></code></pre></div>
<p><strong>4.4.Script’e Çalışma İzni Verme (Slave):</strong></p>
<div class="sourceCode" id="cb38"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>    <span class="fu">sudo</span> chmod +x /opt/backup.sh</span></code></pre></div>
<p><strong>4.5.Jenkins Job’unu Build Alma:</strong> </p>
<p>Jenkins’teki ilgili Job’u çalıştırın.</p>
<figure>
<img src="/image/dokuman2_ss/manuel-build-backıp-script-build.png"
alt="image" />
<figcaption aria-hidden="true">image</figcaption>
</figure>
<h2 id="cron-ile-build-alma-1">2. Cron ile Build Alma</h2>
<p>Cron ile build alma, Jenkins’teki Job’ların belirli zaman
aralıklarında otomatik olarak çalıştırılmasını sağlar.</p>
<p><strong>Adımlar:</strong></p>
<ol type="1">
<li><strong>Job Yapılandırması:</strong> Jenkins’teki ilgili Job’u açın
ve yapılandırma sayfasına gidin.</li>
<li><strong>Triggers Bölümü:</strong> “Build Triggers” bölümünü
bulun.</li>
<li><strong>Build Periodically:</strong> “Build periodically” seçeneğini
işaretleyin.</li>
<li><strong>Zamanlama Ayarı:</strong> Cron ifadesini kullanarak
zamanlama ayarlarını yapın. Örneğin, her gece 03:00’te çalıştırmak
için: 0 3 * * *</li>
</ol>
<p><strong>Not:</strong> Cron ifadelerini Jenkins Job bazlı yönetmek,
sunucudaki cron ayarlarını yönetmekten daha kolaydır, özellikle sunucu
sayısı arttığında.</p>
<h2 id="trigger-ile-build-alma-1">3. Trigger ile Build Alma</h2>
<p>Bu adım, Gitlab gibi versiyon kontrol sistemlerindeki değişikliklerin
otomatik olarak Jenkins build’lerini tetiklemesini sağlar.</p>
<p><strong>Adımlar:</strong></p>
<ol type="1">
<li><strong>Gitlab Entegrasyonu:</strong> Jenkins ve Gitlab arasında
entegrasyon sağlamak için gerekli eklentileri kurun ve
yapılandırın.</li>
<li><strong>Webhook Oluşturma (Gitlab):</strong> Gitlab’ta, ilgili proje
için bir webhook oluşturun. Bu webhook, değişiklik olduğunda Jenkins’e
bildirim gönderecektir.
<ul>
<li><strong>URL:</strong> Jenkins sunucusunun URL’si ve Job’un build
URL’si. Örneğin: https://jenkins.example.com/job/your_job/build</li>
<li><strong>Secret Token:</strong> Gitlab ve Jenkins arasındaki
güvenliği sağlamak için bir secret token kullanın.</li>
</ul></li>
<li><strong>Jenkins’te Token Oluşturma:</strong>
<ul>
<li>Jenkins’te kullanıcı hesabınıza gidin.</li>
<li><strong>Configure</strong> sayfasına gidin.</li>
<li><strong>API Token</strong> bölümünde bir token oluşturun.</li>
</ul></li>
<li><strong>Gitlab Webhook Ayarları:</strong> Gitlab webhook
ayarlarında:
<ul>
<li><strong>Secret token</strong> alanına oluşturduğunuz token’ı
girin.</li>
<li>Hangi olayların webhook’u tetikleyeceğini seçin (push, merge request
vb.).</li>
</ul></li>
</ol>
<p><strong>Örnek Curl Komutu (Gitlab’tan Jenkins’i
Tetikleme):</strong></p>
<div class="sourceCode" id="cb39"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="ex">curl</span> <span class="at">-X</span> POST <span class="at">-L</span> <span class="at">--user</span> your-user-name:apiToken <span class="dt">\</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>https://jenkins.example.com/job/your_job/build</span></code></pre></div>
<ul>
<li>your-user-name: Jenkins kullanıcı adınız.</li>
<li>apiToken: Jenkins’te oluşturduğunuz API token.</li>
<li>your_job: Jenkins’teki Job’un adı.</li>
</ul>
<p><strong>Not:</strong> Jenkins lokalde çalışıyorsa ve Gitlab’daki
branch’lerden tetiklenmesi isteniyorsa, Gitlab’ın da yerelde olması
tercih edilir. Alternatif olarak, Cloudflare Tunnel gibi servisler
kullanılabilir.</p>
<h3 id="cloudflare-tunnel-ve-benzeri-servisler">6. Cloudflare Tunnel ve
Benzeri Servisler</h3>
<p>Bu servisler, dışarıdaki bir yapının içerideki bir sunucuya ulaşması
gerektiğinde kullanılır.</p>
<p><strong>Örnek Servisler:</strong></p>
<ul>
<li><strong>Cloudflare Tunnel:</strong> Güvenli bir tünel oluşturma
hizmeti.</li>
<li><strong>ngrok:</strong> Yerel sunucuları internete açmak için
kullanılır.</li>
<li><strong>Pagekite:</strong> Yerel sunucuları internete açmak için
kullanılır.</li>
<li><strong>Serveo:</strong> SSH tünelleme kullanarak yerel sunucuları
internete açar.</li>
</ul>
<h2 id="jenkins-user-yönetimi-ve-parametrik-joblar-1">Jenkins User
Yönetimi ve Parametrik Job’lar</h2>
<p>Bu notlar, Jenkins’te kullanıcı yönetimi, rol tabanlı yetkilendirme
ve parametrik job’lar hakkında bilgi içermektedir.</p>
<h3 id="user-yönetimi">1. User Yönetimi</h3>
<p>Jenkins’te kullanıcı yönetimi, kimlerin Jenkins’e erişebileceğini ve
hangi yetkilere sahip olacağını belirlemeyi sağlar.</p>
<p><strong>Yöntemler:</strong></p>
<ul>
<li><strong>Manuel User Oluşturma:</strong>
<ul>
<li><strong>Admin Paneli:</strong> Manage Jenkins → Users yolunu
izleyerek yeni kullanıcılar oluşturabilirsiniz.</li>
<li><strong>Config Dosyası:</strong> Kullanıcı
bilgileri /var/lib/jenkins/config.xml dosyasında saklanır. Bu dosyanın
yedeklenmesi önemlidir.</li>
</ul></li>
<li><strong>LDAP/Active Directory Entegrasyonu:</strong> Jenkins’i LDAP
veya Active Directory ile entegre ederek kullanıcıları bu dizin
servislerinden alabilirsiniz.</li>
</ul>
<p><strong>Uygulama Örneği:</strong></p>
<p><strong>Manuel User Oluşturma:</strong> 4 adet kullanıcı manuel
olarak oluşturuldu.</p>
<figure>
<img src="/image/dokuman2_ss/user-olusturma.png" alt="image" />
<figcaption aria-hidden="true">image</figcaption>
</figure>
<p><strong>Jenkins Konfigürasyonunu Yedekleme:</strong></p>
<ul>
<li><p>/var/lib/jenkins/config.xml dosyasını güvenli bir lokasyona
kopyalayın.</p></li>
<li><p>Örneğin: cp /var/lib/jenkins/config.xml
/home/jenkins-backup/</p></li>
<li><p><strong>Yedek Kontrolü:</strong> Dosyaların hash değerlerini alıp
karşılaştırarak yedeklemenin başarılı olduğundan emin olun.</p></li>
</ul>
<p><strong>Yetkilendirme Testi:</strong> Bir Job’a sadece okuma yetkisi
verin ve gizli modda giriş yaparak yetkilendirmenin doğru çalıştığını
kontrol edin.</p>
<h3
id="rol-tabanlı-yetkilendirme-rbac-ve-matris-tabanlı-yetkilendirme">2.
Rol Tabanlı Yetkilendirme (RBAC) ve Matris Tabanlı Yetkilendirme</h3>
<p>Jenkins’te yetkilendirme, kullanıcıların veya grupların belirli
eylemleri gerçekleştirmesine izin vermek için farklı yöntemlerle
yönetilebilir. İki yaygın yöntem Role-Based (RBAC) ve Matrix-Based
Security’dir.</p>
<p>1️⃣ Role-Based Authorization Strategy (RBAC)</p>
<p>Bu yöntemde kullanıcılara roller atanır ve bu roller belirli
yetkilerle ilişkilendirilir. Böylece aynı role sahip kullanıcılar,
sistem içinde aynı izinlere sahip olur.</p>
<p>Özellikleri:</p>
<p>✅ Kullanıcıları gruplar halinde yöneterek merkezi kontrol sağlar. ✅
Global, Job ve Agent seviyelerinde roller oluşturulabilir. ✅ Büyük
organizasyonlar için uygundur, yeni kullanıcılar sadece ilgili role
atanarak yetkilendirilebilir.</p>
<p><img src="/image/dokuman2_ss/role-based-plugin.png" alt="image" />
<img src="/image/dokuman2_ss/security-role-base.png" alt="image" /> <img
src="/image/dokuman2_ss/manage-roles.png" alt="image" /> <img
src="/image/dokuman2_ss/assign-roles.png" alt="image" /></p>
<p>2️⃣ Matrix-Based Security</p>
<p>Bu yöntemde kullanıcılar veya gruplar doğrudan yetkilendirilir,
roller kullanılmaz. Kullanıcı bazında hassas ve detaylı izin ayarı
yapmak gerektiğinde kullanışlıdır.</p>
<p>Özellikleri:</p>
<p>✅ Kullanıcı ve gruplara doğrudan izinler atanabilir. ✅ RBAC’ye göre
daha esnektir, her kullanıcı için farklı yetki seviyeleri
belirlenebilir. ✅ Küçük ekiplerde veya detaylı yetkilendirme gereken
durumlarda daha uygundur.</p>
<p><img src="/image/dokuman2_ss/matrix-based-plugin.png" alt="image" />
<img src="/image/dokuman2_ss/security-matrix-based.png"
alt="image" /></p>
<h3 id="parametrik-joblar">3. Parametrik Job’lar</h3>
<p>Parametrik Job’lar, kullanıcıların bir build’i başlatırken
değerlerini belirleyebileceği parametreler tanımlamanıza olanak tanır.
Bu, aynı Job’u farklı konfigürasyonlarla çalıştırmayı kolaylaştırır.</p>
<p><strong>Adımlar:</strong></p>
<ol type="1">
<li><strong>Job Yapılandırması:</strong> İlgili Job’un yapılandırma
sayfasına gidin.</li>
<li><strong>This project is parameterized:</strong> “This project is
parameterized” seçeneğini işaretleyin.</li>
<li><strong>Parametre Tanımlama:</strong>
<ul>
<li><strong>String Parameter:</strong> Metin tabanlı değerler için.</li>
<li><strong>Boolean Parameter:</strong> Doğru/Yanlış değerleri
için.</li>
<li><strong>Choice Parameter:</strong> Önceden tanımlanmış seçenekler
arasından seçim yapmak için.</li>
<li><strong>File Parameter:</strong> Bir dosya yüklemek için.</li>
</ul></li>
<li><strong>Parametreleri Kullanma:</strong> Build adımlarında parametre
değerlerine $PARAMETRE_ADI şeklinde erişebilirsiniz. Örneğin, bir shell
script’te parametre değerini kullanmak için:</li>
</ol>
<div class="sourceCode" id="cb40"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>    <span class="bu">echo</span> <span class="st">&quot;Parametre değeri: </span><span class="va">$MY_PARAMETER</span><span class="st">&quot;</span></span></code></pre></div>
<p><strong>Örnek Senaryolar:</strong></p>
<ul>
<li><strong>Ortam Seçimi:</strong> Hangi ortamda (development, staging,
production) build alınacağını belirlemek için.</li>
<li><strong>Sürüm Numarası:</strong> Uygulama sürümünü belirlemek
için.</li>
<li><strong>Branch Seçimi:</strong> Hangi Git branch’inin build
alınacağını seçmek için.</li>
</ul>
<p><img src="/image/dokuman2_ss/parametrik-job1.png" alt="image" /> <img
src="/image/dokuman2_ss/parametrik-job2.png" alt="image" /> <img
src="/image/dokuman2_ss/parametrik-job3.png" alt="image" /> <img
src="/image/dokuman2_ss/parametrik-job4.png" alt="image" /> <img
src="/image/dokuman2_ss/parametrik-job5.png" alt="image" /> <img
src="/image/dokuman2_ss/parametrik-job6.png" alt="image" /> <img
src="/image/dokuman2_ss/parametrik-job7.png" alt="image" /> <img
src="/image/dokuman2_ss/parametrik-job8.png" alt="image" /></p>
<p><strong>Kaynaklar:</strong></p>
<ul>
<li><strong>Role Strategy Plugin:</strong> <a
href="https://www.google.com/url?sa=E&amp;q=https%3A%2F%2Fplugins.jenkins.io%2Frole-strategy%2F"><strong>https://plugins.jenkins.io/role-strategy/</strong></a></li>
<li><strong>Medium Makalesi (User ve Rol Yönetimi):</strong> <a
href="https://www.google.com/url?sa=E&amp;q=https%3A%2F%2Fmedium.com%2F%40srghimire061%2Fhow-to-manage-users-and-roles-in-jenkins-fe6a7a8be344"><strong>https://medium.com/<span
class="citation"
data-cites="srghimire061/how-to-manage-users-and-roles-in-jenkins-fe6a7a8be344">@srghimire061/how-to-manage-users-and-roles-in-jenkins-fe6a7a8be344</span></strong></a></li>
</ul>
<hr />
<h1 id="bölüm-3">BÖLÜM-3</h1>
<h2 id="içindekiler-2">İÇİNDEKİLER:</h2>
<h3 id="pipeline-stage-view-eklentisi-kurulumu"><strong>1. Pipeline:
Stage View Eklentisi Kurulumu</strong></h3>
<h3 id="groovy-ile-basit-bir-pipeline-oluşturma"><strong>2. Groovy ile
Basit Bir Pipeline Oluşturma</strong></h3>
<h3 id="jenkins-credential-yönetimi"><strong>3. Jenkins Credential
Yönetimi</strong></h3>
<h3 id="generate-declarative-directive-kullanımı"><strong>4. Generate
Declarative Directive Kullanımı</strong></h3>
<h3
id="jenkins-agentları-ile-dağıtık-build-ortamları-oluşturma"><strong>5.
Jenkins Agent’ları ile Dağıtık Build Ortamları Oluşturma</strong></h3>
<h3 id="java-uygulamaları-için-tool-ekleme-maven-örneği"><strong>6. Java
Uygulamaları için Tool Ekleme (Maven Örneği)</strong></h3>
<hr />
<p><strong>1. Pipeline: Stage View Eklentisi Kurulumu</strong></p>
<p>Bu plugin ile pipeline çıktısını aşamalar halinde görebilir ve her
aşamanın durumunu kolayca takip edebiliriz.</p>
<p><strong>2. Groovy ile Basit Bir Pipeline Oluşturma</strong></p>
<p>Jenkins arayüzünden Groovy script’i kullanarak basit bir Pipeline
oluşturalım.</p>
<ol type="1">
<li>Jenkins ana sayfasında, “New Item—&gt;Pipeline”</li>
<li>Bir isim verin (örneğin, “groovy-pipeline”).</li>
<li>“OK”a tıklayın.</li>
<li>Pipeline yapılandırma sayfasında, “Pipeline” bölümüne gidin, menüden
“Pipeline script’i” seçeneğini seçin.Aşağıdaki Groovy kodunu metin
alanına yapıştırın:</li>
</ol>
<div class="sourceCode" id="cb41"><pre
class="sourceCode groovy"><code class="sourceCode groovy"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>pipeline <span class="op">{</span></span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>    agent any</span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>    stages <span class="op">{</span></span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>        <span class="fu">stage</span><span class="op">(</span><span class="st">&#39;Merhaba&#39;</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a>            steps <span class="op">{</span></span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a>                echo <span class="st">&#39;Merhaba Dünya!&#39;</span></span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a>            <span class="op">}</span></span>
<span id="cb41-9"><a href="#cb41-9" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb41-10"><a href="#cb41-10" aria-hidden="true" tabindex="-1"></a>        <span class="fu">stage</span><span class="op">(</span><span class="st">&#39;Tarih&#39;</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb41-11"><a href="#cb41-11" aria-hidden="true" tabindex="-1"></a>            steps <span class="op">{</span></span>
<span id="cb41-12"><a href="#cb41-12" aria-hidden="true" tabindex="-1"></a>                sh <span class="st">&#39;date&#39;</span></span>
<span id="cb41-13"><a href="#cb41-13" aria-hidden="true" tabindex="-1"></a>            <span class="op">}</span></span>
<span id="cb41-14"><a href="#cb41-14" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb41-15"><a href="#cb41-15" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb41-16"><a href="#cb41-16" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<ol start="5" type="1">
<li>“Save” ile kaydedin.</li>
<li>“Build Now” ile pipeline ı çalıştırın.</li>
</ol>
<figure>
<img src="/image/dokuman3_ss/pipelinestatus.png" alt="image" />
<figcaption aria-hidden="true">image</figcaption>
</figure>
<p><strong>Jenkins’te pipeline oluşturmanın iki temel yolu
vardır:</strong></p>
<p>Jenkins Arayüzünde Doğrudan Kodlama (“<strong>Pipeline
script</strong>”): Bu yöntemde, pipeline betiğini doğrudan Jenkins
işinin yapılandırma sayfasındaki metin alanına yazarsınız.</p>
<p>SCM’den Pipeline Betiği Çekme (“<strong>Pipeline script from
SCM</strong>”): Bu yöntemde, pipeline betiğini (genellikle Jenkinsfile
adında) bir versiyon kontrol sisteminde saklarsınız. Jenkins, pipeline’ı
çalıştırdığında betiği otomatik olarak SCM’den çeker.</p>
<figure>
<img src="/image/dokuman3_ss/pipeline-olusturma.png" alt="image" />
<figcaption aria-hidden="true">image</figcaption>
</figure>
<ol start="3" type="1">
<li>Jenkins Credential Yönetimi</li>
</ol>
<p>Jenkins’te hassas bilgileri (şifreler, API anahtarları vb.) güvenli
bir şekilde saklamak için credential özelliğini kullanabilirsiniz.</p>
<p>Amaç: Pipeline’larda güvenli bir şekilde hassas bilgileri
kullanmak.</p>
<p>Adımlar: Jenkins ana sayfasında, “Manage Jenkins -&gt; Credentials
-&gt; System -&gt; Global credentials (unrestricted)” bölümünden add new
credential’a tıklayarak yeni credential oluşturun.</p>
<figure>
<img src="/image/dokuman3_ss/credential1.png" alt="image" />
<figcaption aria-hidden="true">image</figcaption>
</figure>
<p>Burada ;</p>
<p>1- Kind: açılır menüden “Secret text” seçeneğini seçin. Bu, gizli bir
metin verisi saklayacağımızı belirtir.</p>
<p>2- Scope: Bu, kimlik bilgilerinin tüm Jenkins projelerinde ve
işlerinde kullanılabileceği anlamına gelir. Genellikle en iyi
seçenektir. Açıklama: Kimlik bilgilerinin kullanılabilirliğini
sınırlamak istiyorsanız, proje veya klasör bazında bir kapsam
seçebilirsiniz. Örneğin, yalnızca belirli bir projede kullanılacak bir
API anahtarı için, o projeyi seçebilirsiniz.</p>
<p>3- Secret: Buraya, saklamak istediğiniz gerçek gizli metin verisini
girin. Bu, gerçekte API anahtarınız, şifreniz veya başka bir hassas
bilginiz olacaktır. Bu alana girilen bilgi Jenkins tarafından
şifrelenerek saklanacaktır.</p>
<p>4- ID: Bu, credential’ımıza verdiğimiz benzersiz ID’dir. Pipeline
kodumuzda bu ID’yi kullanarak credential’a başvuracağız. Açıklama:
Anlamlı ve kolayca hatırlanabilir bir ID seçin. Boşluk veya özel
karakterler kullanmaktan kaçının.</p>
<p>5- Description: Credential’ımızın ne için kullanıldığını açıklayan
bir metindir. Açıklama: Açıklayıcı bir metin girmeniz, gelecekte bu
credential’ı kimin veya neyin kullandığını anlamanıza yardımcı
olacaktır. Ne tür bir veri sakladığınızı ve nerede kullanıldığını
belirtmek faydalı olabilir.</p>
<p>6- “Create” Butonuna Tıklayın</p>
<p>New Item’dan yeni bir pipeline oluşturun:</p>
<pre><code>pipeline {
    agent any

    stages {
        stage(&#39;Write Secret to File&#39;) {
            steps {
                withCredentials([string(credentialsId: &#39;Secret_data&#39;, variable: &#39;SECRET_VALUE&#39;)]) {
                    script {
                        // Gizli değeri bir dosyaya yaz
                        def secretFilePath = &#39;secret.txt&#39;
                        writeFile file: secretFilePath, text: &quot;$SECRET_VALUE&quot;

                        // Dosyanın içeriğini konsola yazdır (isteğe bağlı, debug için)
                        //sh &quot;cat ${secretFilePath}&quot;

                        // Dosyanın oluşturulduğunu doğrulamak için bir mesaj yazdır (isteğe bağlı)
                        echo &quot;Secret value has been written to ${secretFilePath}&quot;
                    }
                }
            }
        }
    }
    post {
        always {
            // Dosyayı artifact olarak arşivle
            archiveArtifacts artifacts: &#39;secret.txt&#39;, allowEmptyArchive: true

            // Dosyayı sil (isteğe bağlı, güvenliği artırmak için)
            //deleteDir()
            //echo &quot;Cleanup complete.&quot;
        }
    }
}</code></pre>
<p>Save butanuna tıklayarak pipeline kaydedebilirsiniz. Ardından “Buil
Now” ile çalıştıralım.</p>
<p><img src="/image/dokuman3_ss/credential2.png" alt="image" /> <img
src="/image/dokuman3_ss/credential3.png" alt="image" /></p>
<p>Aşağıdaki ekran görüntüsü, pipeline tarafından oluşturulan secret.txt
adlı artifact’e tıklandığında açılan içeriği göstermektedir. Bu dosya,
Jenkins tarafından güvenli bir şekilde saklanan Secret_data adlı
credential’dan alınan gizli metni içermektedir.</p>
<figure>
<img src="/image/dokuman3_ss/credential4.png" alt="image" />
<figcaption aria-hidden="true">image</figcaption>
</figure>
<ol start="4" type="1">
<li>Generate Declarative Directive Kullanımı</li>
</ol>
<p>Jenkins’te “Generate Declarative Directive” veya “Pipeline Syntax”
olarak bilinen araç, Declarative Pipeline sözdizimini öğrenmeyi ve
kullanmayı kolaylaştırmak için tasarlanmıştır. Bu araç, kullanıcı
arayüzü üzerinden belirli adımları yapılandırarak, karşılık gelen
Declarative Pipeline kodunu otomatik olarak oluşturmanıza olanak
tanır.</p>
<p><img src="/image/dokuman3_ss/dec-dir-gen1.png" alt="image" /> <img
src="/image/dokuman3_ss/dec-dir-gen2.png" alt="image" /> <img
src="/image/dokuman3_ss/dec-dir-gen3.png" alt="image" /></p>
<p><strong>Jenkins Agent’ları ile Dağıtık Build Ortamları
Oluşturma</strong></p>
<p>Jenkins agent’ları, Jenkins master sunucusunun iş yükünü dağıtmak ve
farklı ortamlarda build işlemleri gerçekleştirmek için kullanılan
bağımsız yürütme ortamlarıdır.</p>
<p><strong>1. Agent Kavramı ve Önemi:</strong></p>
<p>Jenkins, build işlemlerini (derleme, test, deployment vb.)
gerçekleştirmek için kaynaklara ihtiyaç duyar. Agent’lar, bu kaynakları
Jenkins master sunucusundan bağımsız olarak sağlayarak aşağıdaki
avantajları sunar:</p>
<ul>
<li><strong>Yük Dengeleme:</strong> Build işlemlerini birden fazla
agent’a dağıtarak master sunucunun yükünü azaltır.</li>
<li><strong>Farklı Ortamlar:</strong> Farklı işletim sistemleri, araçlar
ve bağımlılıklar gerektiren projeler için özel agent’lar
oluşturulabilir.</li>
<li><strong>Paralel Build:</strong> Birden fazla agent kullanarak build
işlemlerini paralel olarak gerçekleştirerek süreci hızlandırır.</li>
</ul>
<p><strong>2. Agent Ekleme ve Yapılandırma:</strong></p>
<p>Agent’lar, Jenkins arayüzünde “Manage Jenkins” -&gt; “Nodes” (veya
“Manage Nodes and Clouds”) bölümünden eklenir ve yönetilir.</p>
<ul>
<li><strong>Node Türü:</strong> “Permanent Agent” (Kalıcı Agent) veya
“Launch agents on demand” (İhtiyaç Duyulduğunda Agent Başlat)
seçeneklerinden birini seçin.</li>
<li><strong>Agent Adı ve Açıklaması:</strong> Agent’a anlamlı bir ad
verin ve açıklamasını ekleyin.</li>
<li><strong>Remote root directory:</strong> Agent üzerinde Jenkins’in
çalışma alanı olarak kullanacağı bir dizin belirtin. Bu dizin,
Jenkins’in agent üzerinde dosyaları saklayacağı ve build işlemlerini
gerçekleştireceği yerdir.</li>
<li><strong>Labels:</strong> Agent’a etiketler atayın. Bu etiketler,
pipeline’larda belirli agent’ları hedeflemek için kullanılır (aşağıdaki
bölümlere bakınız).</li>
</ul>
<p><strong>3. SSH Anahtar Tabanlı Kimlik Doğrulama ile Agent
Bağlantısı:</strong></p>
<p>Agent’lar, Jenkins master sunucusu ile SSH protokolü üzerinden
güvenli bir şekilde iletişim kurar. SSH anahtar tabanlı kimlik
doğrulama, şifre tabanlı kimlik doğrulamaya göre daha güvenli bir
yöntemdir.</p>
<ul>
<li><p><strong>3.1. SSH Anahtar Çifti Oluşturma:</strong></p>
<p>Agent üzerinde aşağıdaki komutu kullanarak bir SSH anahtar çifti
oluşturun:</p>
<div class="sourceCode" id="cb43"><pre
class="sourceCode groovy"><code class="sourceCode groovy"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>ssh<span class="op">-</span>keygen <span class="op">-</span>t rsa <span class="op">-</span>b <span class="dv">4096</span> <span class="op">-</span>N <span class="st">&quot;&quot;</span> <span class="op">-</span>f <span class="op">~</span><span class="st">/.ssh/</span>id_rsa</span></code></pre></div>
<p>Bu komut, ~/.ssh dizininde id_rsa (private key) ve id_rsa.pub (public
key) olmak üzere iki dosya oluşturur. </p></li>
<li><p><strong>3.2. Public Key’i Agent’a Yetkilendirme:</strong></p>
<p>Agent üzerindeki ~/.ssh/authorized_keys dosyasına, public key’in
içeriğini ekleyin. Eğer dosya yoksa oluşturun ve doğru izinleri
ayarlayın:</p>
<div class="sourceCode" id="cb44"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mkdir</span> <span class="at">-p</span> ~/.ssh</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a><span class="fu">chmod</span> 700 ~/.ssh</span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a><span class="fu">touch</span> ~/.ssh/authorized_keys</span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a><span class="fu">chmod</span> 600 ~/.ssh/authorized_keys</span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a><span class="fu">nano</span> ~/.ssh/authorized_keys <span class="co"># public key buraya yapıştırılır</span></span></code></pre></div>
<p>nano veya tercih ettiğiniz bir metin düzenleyici
ile ~/.ssh/authorized_keys dosyasını açın ve public key’in içeriğini
( cat ~/.ssh/id_rsa.pub komutu ile elde edebilirsiniz) dosyanın sonuna
yapıştırın.</p></li>
<li><p><strong>3.3. Jenkins’te SSH Credential Oluşturma:</strong></p>
<p>Jenkins’te, “Credentials” bölümüne gidin ve yeni bir credential
ekleyin:</p>
<ul>
<li><strong>Kind:</strong> SSH Username with private key</li>
<li><strong>Scope:</strong> Global (veya ihtiyacınıza göre daha kısıtlı
bir kapsam)</li>
<li><strong>Username:</strong> Agent üzerinde SSH erişimine sahip olan
kullanıcı adı (örneğin, ubuntu, ec2-user, jenkins).</li>
<li><strong>Private Key:</strong> Oluşturduğunuz SSH private key’in
içeriğini yapıştırın veya dosyadan yükleyin (~/.ssh/id_rsa).</li>
<li><strong>ID:</strong> Credential’a benzersiz bir ID verin
(örneğin, agent_ssh_key).</li>
<li><strong>Description:</strong> Credential’ın ne için kullanıldığını
açıklayan bir metin girin.</li>
</ul></li>
<li><p><strong>3.4. Agent Konfigürasyonu:</strong></p>
<p>“Manage Jenkins” -&gt; “Nodes” bölümünde, oluşturduğunuz agent’ı
düzenleyin:</p>
<ul>
<li>“Launch method” (Başlatma yöntemi) olarak “Launch agents via SSH”
seçeneğini seçin.</li>
<li>“Host Key Verification Strategy” (Host Anahtarı Doğrulama
Stratejisi) olarak “Manually trusted key Verification Strategy” veya
“Non verifying Verification Strategy” seçeneğini seçin.</li>
<li>“Credentials” (Kimlik Bilgileri) açılır menüsünden, oluşturduğunuz
SSH credential’ı seçin.</li>
<li>“Host” name alanına agent’ın IP adresini veya hostname’ini
yazın.</li>
</ul></li>
</ul>
<p><strong>4. Pipeline’larda Agent Kullanımı:</strong></p>
<p>Pipeline’larda agent direktifi ile belirli agent’ları
hedefleyebilirsiniz.</p>
<ul>
<li><strong>Label ile Agent Seçimi:</strong></li>
</ul>
<pre><code>pipeline {
    agent { label &#39;my-agent&#39; } // &quot;my-agent&quot; etiketine sahip agent&#39;ta çalışır
    stages {
        stage(&#39;Build&#39;) {
            steps {
                sh &#39;echo &quot;Build aşaması çalışıyor...&quot;&#39;
            }
        }
    }
}</code></pre>
<p>Agent Bağlantısı;</p>
<figure>
<img src="/image/dokuman3_ss/agent-baglantisi.png" alt="image" />
<figcaption aria-hidden="true">image</figcaption>
</figure>
<p>Pipeline’da kullanımı</p>
<p><img src="/image/dokuman3_ss/agent-pipeline.png" alt="image" /> <img
src="/image/dokuman3_ss/agent-pipeline2.png" alt="image" /></p>
<p>Eğer pipeline’ın tamamının belirli bir agent üzerinde çalışmasını
istemiyorsanız, agent none direktifini kullanabilirsiniz. Bu durumda,
her bir stage’in kendi agent direktifini içermesi gerekir.</p>
<pre><code>pipeline {
    agent none
    stages {
        stage(&#39;Build&#39;) {
            agent { label &#39;my-agent&#39; }
            steps {
                sh &#39;echo &quot;Build aşaması çalışıyor...&quot;&#39;
            }
        }
        stage(&#39;Test&#39;) {
            agent { label &#39;another-agent&#39; }
            steps {
                sh &#39;echo &quot;Test aşaması çalışıyor...&quot;&#39;
            }
        }
    }
}</code></pre>
<p><strong>Java Uygulamaları için Tool Ekleme (Maven
Örneği):</strong></p>
<p>Java uygulamaları için genellikle Maven gibi build araçlarına ihtiyaç
duyulur. Jenkins, bu araçları otomatik olarak yükleyebilir veya önceden
yüklenmiş araçları kullanabilir.</p>
<figure>
<img src="/image/dokuman3_ss/mvn-tool.png" alt="image" />
<figcaption aria-hidden="true">image</figcaption>
</figure>
<ul>
<li><strong>“Manage Jenkins” -&gt; “Global Tool
Configuration”</strong> bölümüne gidin.</li>
<li>Maven bölümünde, “Maven installations” ekleyin.</li>
<li><strong>“Name”</strong> alanına Maven kurulumuna bir isim verin
(örneğin, Maven 3.8.1).</li>
<li><strong>“Installation directory”</strong> Eğer agent üzerinde maven
zaten varsa kurulum dizinini belirtin.</li>
<li><strong>“Install automatically”</strong> Eğer maven otomatik
kurulacaksa bu seçeneği seçin ve jenkinsin belirtiği url den kurulumu
yapın.</li>
<li><strong>“Install from local directory”</strong> Eğer lokalde olan
bir maven kullanılacaksa bu seçeneği seçin ve dizini belirtin.</li>
<li><strong>Spesifik Bir URL’den Çekme:</strong> Jenkins’in belirtilen
URL’den Maven’i indirmesini ve kurmasını sağlayabilirsiniz. Bu seçenek,
belirli bir Maven sürümüne ihtiyaç duyduğunuzda kullanışlıdır.</li>
</ul>
<p>Jenkins, build işlemi sırasında gerekli olan Maven’i otomatik olarak
agent’a yükleyecektir.</p>
<hr />
<h1
id="bölüm-4-jenkins-ve-tomcat-ile-java-web-uygulaması-dağıtımı">BÖLÜM-4
Jenkins ve Tomcat ile Java Web Uygulaması Dağıtımı</h1>
<h2 id="içindekiler-3">İÇİNDEKİLER:</h2>
<h3 id="tomcat-11-kurulumu"><strong>1. Tomcat 11 Kurulumu</strong></h3>
<h3 id="tomcat-kullanıcılarını-yapılandırma"><strong>2. Tomcat
Kullanıcılarını Yapılandırma</strong></h3>
<h3
id="uzaktan-erişimi-yapılandırma-jenkins-ve-tomcat-farklı-sunucularda-ise"><strong>3.
Uzaktan Erişimi Yapılandırma (Jenkins ve Tomcat Farklı Sunucularda
ise)</strong></h3>
<h3 id="tomcati-başlat"><strong>4. Tomcat’i Başlat</strong></h3>
<h3
id="jenkinste-gerekli-eklentiyi-yükleme-deploy-to-container-plugin"><strong>5.
Jenkins’te Gerekli Eklentiyi Yükleme: Deploy to container
Plugin</strong></h3>
<h3 id="global-tool-configuration-maven-yapılandırması"><strong>6.
Global Tool Configuration (Maven Yapılandırması)</strong></h3>
<h3 id="jenkins-pipeline-oluşturma-ve-yapılandırma"><strong>7. Jenkins
Pipeline Oluşturma ve Yapılandırma</strong></h3>
<h3
id="credential-ve-pipeline-entegrasyonu-tomcat-deploy-credential"><strong>8.
Credential ve Pipeline Entegrasyonu (tomcat-deploy
Credential)</strong></h3>
<h3 id="pipelineı-çalıştırın-ve-sonuçları-izleyin"><strong>9. Pipeline’ı
Çalıştırın ve Sonuçları İzleyin</strong></h3>
<h3
id="alternatif-deployment-yöntemi-deploy-war-to-tomcat-without-plugin-pluginsiz-dağıtım"><strong>10.
Alternatif Deployment Yöntemi: “deploy-war-to-tomcat-without-plugin”
(Pluginsiz Dağıtım)</strong></h3>
<h3 id="jenkins-configuration-as-code-jcasc"><strong>11. Jenkins
Configuration as Code (JCasc)</strong></h3>
<h3 id="seed-jobs-ve-job-dsl"><strong>12. Seed Jobs ve Job
DSL</strong></h3>
<hr />
<p><strong>Jenkins ve Tomcat ile Java Web Uygulaması
Dağıtımı</strong></p>
<p>Bu bölümde, bir Java web uygulamasının Jenkins tarafından otomatik
olarak Tomcat 11 sunucusuna nasıl dağıtılacağını bakacağız.</p>
<p><strong>Tomcat 11 Kurulumu:</strong></p>
<p>Aşağıdaki adımlar, Tomcat 11’in /opt dizinine kurulmasını
göstermektedir:</p>
<ol type="1">
<li><p><strong>Dizine Git:</strong></p>
<div class="sourceCode" id="cb47"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a><span class="bu">cd</span> /opt</span></code></pre></div></li>
<li><p><strong>Tomcat 11’i İndir:</strong></p>
<div class="sourceCode" id="cb48"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a><span class="fu">wget</span> https://dlcdn.apache.org/tomcat/tomcat-11/v11.0.3/bin/apache-tomcat-11.0.3.tar.gz</span></code></pre></div></li>
<li><p><strong>Arşivi Çıkar:</strong></p>
<div class="sourceCode" id="cb49"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a><span class="fu">tar</span> <span class="at">-xf</span> apache-tomcat-11.0.3.tar.gz</span></code></pre></div></li>
</ol>
<p><strong>Tomcat Kullanıcılarını Yapılandırma:</strong></p>
<p>Tomcat’in web arayüzüne erişim ve uygulamaların dağıtımı için
kullanıcıları yapılandırmanız gerekmektedir.</p>
<ol type="1">
<li><strong>tomcat-users.xml Dosyasını Düzenle:</strong></li>
</ol>
<div class="sourceCode" id="cb50"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a><span class="fu">nano</span> /opt/apache-tomcat-11.0.3/conf/tomcat-users.xml</span></code></pre></div>
<ol type="1">
<li><p><strong>Kullanıcıları Ekle:</strong></p>
<p>Aşağıdaki kod bloğunu tomcat-users.xml dosyasına ekleyin
( <tomcat-users> etiketi içinde):</p>
<div class="sourceCode" id="cb51"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a><span class="op">&lt;</span>role <span class="va">rolename</span><span class="op">=</span><span class="st">&quot;manager-gui&quot;</span>/<span class="op">&gt;</span></span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a><span class="op">&lt;</span>role <span class="va">rolename</span><span class="op">=</span><span class="st">&quot;manager-script&quot;</span>/<span class="op">&gt;</span></span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a><span class="op">&lt;</span>role <span class="va">rolename</span><span class="op">=</span><span class="st">&quot;manager-jmx&quot;</span>/<span class="op">&gt;</span></span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a><span class="op">&lt;</span>role <span class="va">rolename</span><span class="op">=</span><span class="st">&quot;manager-status&quot;</span>/<span class="op">&gt;</span></span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a><span class="op">&lt;</span>user <span class="va">username</span><span class="op">=</span><span class="st">&quot;admin&quot;</span></span>
<span id="cb51-8"><a href="#cb51-8" aria-hidden="true" tabindex="-1"></a>      <span class="va">password</span><span class="op">=</span><span class="st">&quot;admin&quot;</span></span>
<span id="cb51-9"><a href="#cb51-9" aria-hidden="true" tabindex="-1"></a>      <span class="va">roles</span><span class="op">=</span><span class="st">&quot;manager-gui,manager-script,manager-jmx,manager-status&quot;</span>/<span class="op">&gt;</span></span>
<span id="cb51-10"><a href="#cb51-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-11"><a href="#cb51-11" aria-hidden="true" tabindex="-1"></a><span class="op">&lt;</span>user <span class="va">username</span><span class="op">=</span><span class="st">&quot;deployer&quot;</span></span>
<span id="cb51-12"><a href="#cb51-12" aria-hidden="true" tabindex="-1"></a>      <span class="va">password</span><span class="op">=</span><span class="st">&quot;deployer&quot;</span></span>
<span id="cb51-13"><a href="#cb51-13" aria-hidden="true" tabindex="-1"></a>      <span class="va">roles</span><span class="op">=</span><span class="st">&quot;manager-script&quot;</span>/<span class="op">&gt;</span></span>
<span id="cb51-14"><a href="#cb51-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-15"><a href="#cb51-15" aria-hidden="true" tabindex="-1"></a><span class="op">&lt;</span>user <span class="va">username</span><span class="op">=</span><span class="st">&quot;tomcat&quot;</span></span>
<span id="cb51-16"><a href="#cb51-16" aria-hidden="true" tabindex="-1"></a>      <span class="va">password</span><span class="op">=</span><span class="st">&quot;s3cret&quot;</span></span>
<span id="cb51-17"><a href="#cb51-17" aria-hidden="true" tabindex="-1"></a>      <span class="va">roles</span><span class="op">=</span><span class="st">&quot;manager-gui&quot;</span>/<span class="op">&gt;</span></span></code></pre></div>
<ul>
<li>admin: Tomcat web arayüzüne tam erişim sağlar.</li>
<li>deployer: Uygulamaların dağıtımı için kullanılır (Jenkins ile
entegrasyon için önerilen kullanıcı).</li>
<li>tomcat: Yalnızca Tomcat web arayüzüne erişim sağlar.</li>
</ul>
<p><strong>Güvenlik Notu:</strong> Üretim ortamında, varsayılan
kullanıcı adlarını ve parolalarını <strong>değiştirin</strong> ve güçlü
parolalar kullanın!</p>
<p><strong>Uzaktan Erişimi Yapılandırma (Jenkins ve Tomcat Farklı
Sunucularda ise):</strong></p>
<p>Eğer Jenkins ve Tomcat <strong>farklı
sunucularda</strong> çalışıyorsa, Jenkins’in Tomcat’e uzaktan
erişebilmesi için Tomcat’te ek yapılandırma yapmanız gerekmektedir. Bu
yapılandırma, Tomcat’in web arayüzüne ve deployment işlevlerine uzaktan
erişime izin vermeyi içerir.</p>
<ol type="1">
<li><p><strong>context.xml Dosyalarını Bul:</strong></p>
<p>Tomcat sunucunuzda, aşağıdaki komutu kullanarak aşağıda belirtilen
dosyaları bulun:</p>
<ul>
<li>/opt/apache-tomcat-11.0.3/webapps/manager/META-INF/context.xml</li>
<li>/opt/apache-tomcat-11.0.3/webapps/host-manager/META-INF/context.xml</li>
</ul></li>
</ol>
<div class="sourceCode" id="cb52"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="fu">find</span> / <span class="at">-name</span> context.xml</span></code></pre></div></li>
</ol>
<p><strong>context.xml Dosyalarını Düzenle:</strong></p>
<p>Her iki context.xml dosyasını da bir metin düzenleyici ile açın
ve <Context> etiketi içinde aşağıdaki <Valve>etiketini bulun</p>
<div class="sourceCode" id="cb53"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a><span class="op">&lt;</span>Valve <span class="va">className</span><span class="op">=</span><span class="st">&quot;org.apache.catalina.valves.RemoteAddrValve&quot;</span> <span class="va">allow</span><span class="op">=</span><span class="st">&quot;127\.\d+\.\d+\.\d+|::1|0:0:0:0:0:0:0:1|JENKINS_SUNUCUSUNUN_IP_ADRESI&quot;</span>/<span class="op">&gt;</span></span></code></pre></div>
<p><strong>JENKINS_SUNUCUSUNUN_IP_ADRESI</strong>: Bu
kısmı, <strong>Jenkins sunucunuzun gerçek IP
adresiyle</strong> değiştirin. Bu, yalnızca belirli bir IP adresinden
(Jenkins sunucusu) Tomcat’in yönetici arayüzüne erişime izin verecektir.
Birden fazla IP adresine izin vermek için, adresleri | karakteriyle
ayırabilirsiniz.(test için allow=“.*” yapılandırabilirsiniz fakat bu
şekilde Tomcat sunucusunun yönetim arayüzünü (manager ve host-manager
uygulamaları) <strong>herhangi bir IP adresinden</strong> gelen
isteklere açmış olursunuz.)</p>
<p><strong>Örnek (Tek IP Adresi):</strong></p>
<div class="sourceCode" id="cb54"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a><span class="op">&lt;</span>Valve <span class="va">className</span><span class="op">=</span><span class="st">&quot;org.apache.catalina.valves.RemoteAddrValve&quot;</span> <span class="va">allow</span><span class="op">=</span><span class="st">&quot;127\.\d+\.\d+\.\d+|::1|0:0:0:0:0:0:0:1|192.168.1.100&quot;</span>/<span class="op">&gt;</span></span></code></pre></div>
<p>Bu örnek, hem yerel erişime (127.0.0.1 ve ::1) hem
de 192.168.1.100 IP adresinden erişime izin verir.</p>
<p><strong>Tomcat’i Başlat:</strong></p>
<div class="sourceCode" id="cb55"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="bu">cd</span> /opt/apache-tomcat-11.0.3/bin/</span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a><span class="ex">./startup.sh</span></span></code></pre></div>
<ul>
<li>Tomcat, güvenlik nedeniyle varsayılan olarak web arayüzüne (manager
uygulaması) ve yönetim işlevlerine yalnızca yerel (localhost) erişime
izin verir. Bu, Tomcat’in yetkisiz erişime karşı korunmasını
sağlar.</li>
<li>Eğer Jenkins ve Tomcat farklı sunucularda çalışıyorsa, Jenkins’in
Tomcat’e uzaktan dağıtım yapabilmesi için, Tomcat’in Jenkins’in IP
adresinden gelen isteklere <strong>açıkça</strong> izin vermesi
gerekir.</li>
<li><Valve> etiketi ve özellikle allow özelliği, Tomcat’e hangi IP
adreslerinden gelen isteklere izin vereceğini belirtmek için
kullanılır.</li>
<li>allow özelliğine <strong>Jenkins’in çalıştığı VM’nin IP
adresini</strong> ekleyerek, Tomcat’e yalnızca Jenkins’in yönetici
arayüzüne erişebileceğini ve dağıtım yapabileceğini söylersiniz.</li>
</ul>
<p><strong>Jenkins’te Gerekli Eklentiyi Yükleme: Deploy to container
Plugin (</strong> Plugin ile dağıtım yöntemi için gereklidir.)</p>
<p><strong>Global Tool Configuration (Maven Yapılandırması, dokuman3 de
burayı yapmıştık. Burada proje içinde kullanılacak mvn versiyonu aynı
olmalı)</strong></p>
<p><strong>Jenkins Pipeline Oluşturma ve Yapılandırma:</strong></p>
<p>Jenkins’te, Tomcat’e dağıtımı otomatikleştirecek bir pipeline
oluşturun:</p>
<ol type="1">
<li><strong>Yeni Pipeline İşi Oluşturun:</strong>
<ul>
<li>Jenkins ana sayfanızda “New Item” seçeneğine tıklayın.</li>
<li>Bir isim verin (örneğin, tomcat-deploy-approve).</li>
<li>“Pipeline” türünü seçin ve “OK” butonuna tıklayın.</li>
</ul></li>
<li><strong>Pipeline Tanımını Yapılandırın:</strong>
<ul>
<li>İş yapılandırma sayfasında, “Pipeline” bölümüne gidin.</li>
<li>“Definition” açılır menüsünden “Pipeline script” seçeneğini
seçin.</li>
<li>pipeline kodunu yazın:</li>
</ul>
<div class="sourceCode" id="cb56"><pre
class="sourceCode groovy"><code class="sourceCode groovy"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>pipeline <span class="op">{</span></span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>    agent <span class="op">{</span></span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a>        label <span class="st">&#39;linux&#39;</span>  <span class="co">// Bu pipeline&#39;ın &quot;linux&quot; etiketine sahip bir agent üzerinde çalışacağını belirtir.</span></span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a>    tools <span class="op">{</span></span>
<span id="cb56-7"><a href="#cb56-7" aria-hidden="true" tabindex="-1"></a>        maven <span class="st">&#39;maven 3.8.6&#39;</span> <span class="co">// Bu pipeline&#39;ın &quot;maven 3.8.6&quot; adında bir Maven kurulumu kullanacağını belirtir.</span></span>
<span id="cb56-8"><a href="#cb56-8" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb56-9"><a href="#cb56-9" aria-hidden="true" tabindex="-1"></a>    stages <span class="op">{</span></span>
<span id="cb56-10"><a href="#cb56-10" aria-hidden="true" tabindex="-1"></a>        <span class="fu">stage</span><span class="op">(</span><span class="st">&#39;Checkout Code&#39;</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb56-11"><a href="#cb56-11" aria-hidden="true" tabindex="-1"></a>            steps <span class="op">{</span></span>
<span id="cb56-12"><a href="#cb56-12" aria-hidden="true" tabindex="-1"></a>                <span class="fu">checkout</span><span class="op">([</span>$class<span class="op">:</span> <span class="st">&#39;GitSCM&#39;</span><span class="op">,</span> branches<span class="op">:</span> <span class="op">[[</span>name<span class="op">:</span> <span class="st">&#39;*/main&#39;</span><span class="op">]],</span> extensions<span class="op">:</span> <span class="op">[],</span> userRemoteConfigs<span class="op">:</span> <span class="op">[[</span>url<span class="op">:</span> <span class="st">&#39;https://gitlab.com/ozguryazilimkiskampi/tomcat-deployment-example.git&#39;</span><span class="op">]]])</span></span>
<span id="cb56-13"><a href="#cb56-13" aria-hidden="true" tabindex="-1"></a>            <span class="op">}</span></span>
<span id="cb56-14"><a href="#cb56-14" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb56-15"><a href="#cb56-15" aria-hidden="true" tabindex="-1"></a>        <span class="fu">stage</span><span class="op">(</span><span class="st">&#39;Test&#39;</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb56-16"><a href="#cb56-16" aria-hidden="true" tabindex="-1"></a>            steps <span class="op">{</span></span>
<span id="cb56-17"><a href="#cb56-17" aria-hidden="true" tabindex="-1"></a>                sh <span class="st">&#39;mvn test&#39;</span></span>
<span id="cb56-18"><a href="#cb56-18" aria-hidden="true" tabindex="-1"></a>            <span class="op">}</span></span>
<span id="cb56-19"><a href="#cb56-19" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb56-20"><a href="#cb56-20" aria-hidden="true" tabindex="-1"></a>        <span class="fu">stage</span><span class="op">(</span><span class="st">&#39;Build&#39;</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb56-21"><a href="#cb56-21" aria-hidden="true" tabindex="-1"></a>            steps <span class="op">{</span></span>
<span id="cb56-22"><a href="#cb56-22" aria-hidden="true" tabindex="-1"></a>                sh <span class="st">&#39;mvn package&#39;</span></span>
<span id="cb56-23"><a href="#cb56-23" aria-hidden="true" tabindex="-1"></a>            <span class="op">}</span></span>
<span id="cb56-24"><a href="#cb56-24" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb56-25"><a href="#cb56-25" aria-hidden="true" tabindex="-1"></a>        <span class="fu">stage</span><span class="op">(</span><span class="st">&quot;Deploy on Test&quot;</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb56-26"><a href="#cb56-26" aria-hidden="true" tabindex="-1"></a>            steps <span class="op">{</span></span>
<span id="cb56-27"><a href="#cb56-27" aria-hidden="true" tabindex="-1"></a>                deploy adapters<span class="op">:</span> <span class="op">[</span></span>
<span id="cb56-28"><a href="#cb56-28" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">tomcat9</span><span class="op">(</span>credentialsId<span class="op">:</span> <span class="st">&#39;tomcat-deploy&#39;</span><span class="op">,</span></span>
<span id="cb56-29"><a href="#cb56-29" aria-hidden="true" tabindex="-1"></a>                     path<span class="op">:</span> <span class="st">&#39;&#39;</span><span class="op">,</span> url<span class="op">:</span> <span class="st">&#39;http://192.168.186.145:8080&#39;</span><span class="op">)],</span></span>
<span id="cb56-30"><a href="#cb56-30" aria-hidden="true" tabindex="-1"></a>                     contextPath<span class="op">:</span> <span class="st">&#39;&#39;</span><span class="op">,</span> war<span class="op">:</span> <span class="st">&#39;**/*.war&#39;</span></span>
<span id="cb56-31"><a href="#cb56-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-32"><a href="#cb56-32" aria-hidden="true" tabindex="-1"></a>            <span class="op">}</span></span>
<span id="cb56-33"><a href="#cb56-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-34"><a href="#cb56-34" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb56-35"><a href="#cb56-35" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb56-36"><a href="#cb56-36" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<ul>
<li>agent { label ‘linux’ }: Pipeline’ın linux etiketine sahip bir agent
üzerinde çalışacağını belirtir. Agent yapılandırması için önceki
bölümlere bakın.</li>
<li>tools { maven ‘maven 3.8.6’ }: Pipeline’ın maven 3.8.6 adında bir
Maven kurulumu kullanacağını belirtir. Global Tool Configuration
bölümünde bu kurulumun yapılandırıldığından emin olun.</li>
<li>checkout: Git repository’sinden kaynak kodunu çeker.</li>
<li>mvn test: Maven ile testleri çalıştırır.</li>
<li>mvn package: Maven ile projeyi paketler (WAR dosyası
oluşturur).</li>
<li>deploy: “Deploy to container Plugin” eklentisini kullanarak WAR
dosyasını Tomcat sunucusuna dağıtır.
<ul>
<li>credentialsId: ‘tomcat-deploy’: Tomcat credential’ının ID’sini
belirtir (önceki adımlarda oluşturduğunuz).</li>
<li>url: ‘http://192.168.186.145:8080’: Tomcat sunucusunun URL’sini
belirtir.</li>
<li>war: ’**/*.war’: Dağıtılacak WAR dosyasının yolunu belirtir.</li>
</ul></li>
</ul></li>
<li><strong>“Save” Butonuna Tıklayarak Pipeline’ı
Kaydedin.</strong></li>
</ol>
<p><strong>Credential ve Pipeline Entegrasyonu (tomcat-deploy
Credential):</strong></p>
<figure>
<img src="/image/dokuman4_ss/tomcat-deploy-cred.png" alt="image" />
<figcaption aria-hidden="true">image</figcaption>
</figure>
<ul>
<li><p><strong>Credential Kimlik Bilgilerini Kontrol
Edin:</strong> tomcat-deploy credential’ının, Tomcat sunucusuna
bağlanmak için doğru kullanıcı adı ve parolaya sahip olduğundan emin
olun. Jenkins -&gt; Credentials bölümünden bu credential’ı kontrol
edebilirsiniz.</p>
<ul>
<li>username: deployer (veya Tomcat’te oluşturduğunuz dağıtım
kullanıcısı)</li>
<li>password: Kullanıcının parolası</li>
</ul></li>
<li><p><strong>Pipeline Kodunda Credential ID’sini Doğru
Kullanın:</strong></p>
<p>Pipeline kodunuzda, deploy adımında doğru credentialsId değerini
kullandığınızdan emin olun (tomcat-deploy).</p></li>
</ul>
<p><strong>Pipeline’ı Çalıştırın ve Sonuçları İzleyin:</strong></p>
<ul>
<li>Pipeline’ı manuel olarak başlatmak için iş sayfasına gidin ve “Build
Now” butonuna tıklayın.</li>
<li>Pipeline’ın konsol çıktısını izleyerek, her aşamanın başarıyla
tamamlandığından emin olun.</li>
<li>Dağıtım başarılı olursa, web uygulamanızın Tomcat sunucusunda
çalıştığını doğrulayın.</li>
</ul>
<p><strong>Alternatif Deployment Yöntemi:
“deploy-war-to-tomcat-without-plugin” (Pluginsiz Dağıtım):</strong></p>
<p>Bazı durumlarda, belirli bir plugin kullanmak yerine, daha esnek bir
çözüm tercih edebilirsiniz. Bu örnekte, “Deploy to container Plugin”
kullanmadan, doğrudan SSH üzerinden Tomcat sunucusuna dağıtım
yapacağız.</p>
<p><strong>Ek Credential Oluşturun (SSH Key ile Kimlik
Doğrulama):</strong></p>
<p>Pluginsiz dağıtım için, Tomcat sunucusuna SSH ile bağlanmak için bir
credential oluşturmanız gerekmektedir. Bu credential, bir SSH private
key içermelidir.</p>
<ul>
<li><strong>SSH Anahtar Çifti Oluşturun:</strong>
<ul>
<li><p>Tomcat sunucusunda (veya Jenkins sunucusunda), aşağıdaki komutu
kullanarak bir SSH anahtar çifti oluşturun:</p>
<div class="sourceCode" id="cb57"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ssh-keygen</span> <span class="at">-t</span> rsa <span class="at">-b</span> 4096 <span class="at">-N</span> <span class="st">&quot;&quot;</span> <span class="at">-f</span> ~/.ssh/id_rsa_deploy</span></code></pre></div>
<p>Bu komut, ~/.ssh dizininde id_rsa_deploy (private key)
ve id_rsa_deploy.pub (public key) dosyalarını oluşturur.</p></li>
</ul></li>
<li><strong>Public Key’i Tomcat Sunucusuna Yetkilendirin:</strong>
<ul>
<li>Tomcat sunucusunda, ~/.ssh/authorized_keys dosyasına public key’in
içeriğini ekleyin:</li>
</ul>
<div class="sourceCode" id="cb58"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mkdir</span> <span class="at">-p</span> ~/.ssh</span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a><span class="fu">chmod</span> 700 ~/.ssh</span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a><span class="fu">touch</span> ~/.ssh/authorized_keys</span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a><span class="fu">chmod</span> 600 ~/.ssh/authorized_keys</span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span> ~/.ssh/id_rsa_deploy.pub <span class="op">&gt;&gt;</span> ~/.ssh/authorized_keys</span></code></pre></div></li>
<li><strong>Jenkins’te SSH Credential Oluşturun:</strong>
<ul>
<li>“Credentials” bölümüne gidin ve yeni bir credential ekleyin:
<ul>
<li><strong>Kind:</strong> SSH Username with private key</li>
<li><strong>Scope:</strong> Global</li>
<li><strong>Username:</strong> Tomcat sunucusunda SSH erişimine sahip
olan kullanıcı adı (örneğin, ubuntu, ec2-user, tomcat).</li>
<li><strong>Private Key:</strong> Oluşturduğunuz SSH private key’in
içeriğini yapıştırın (~/.ssh/id_rsa_deploy).</li>
<li><strong>ID:</strong> Credential’a benzersiz bir ID verin
(örneğin, tomcat_ssh_key).</li>
<li><strong>Description:</strong> Credential’ın ne için kullanıldığını
açıklayan bir metin girin (örneğin, “Tomcat sunucusuna SSH erişimi
için”).</li>
</ul></li>
</ul></li>
<li><strong>Pipeline’ı Oluşturun:</strong></li>
<li><strong>Önemli Not: Nexus Entegrasyonu (Opsiyonel)</strong></li>
</ul>
<p>Bu pipeline, üretilen artifact’ı (WAR dosyası) Nexus Repository
Manager’a yükleme adımlarını içermektedir. <strong>Nexus kullanımı
tamamen opsiyoneldir.</strong> Eğer Nexus kullanmıyorsanız,
pipeline’daki “Publish to Nexus”
aşamasını <strong>kaldırabilir</strong> veya devre dışı
bırakabilirsiniz. <strong>Nexus Kullanılıyorsa “Nexus Artifact Uploader”
plugin’in kurmak gerekir.</strong></p>
<div class="sourceCode" id="cb59"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a><span class="ex">pipeline</span> {</span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a>    <span class="ex">agent</span> {</span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a>        <span class="ex">label</span> <span class="st">&#39;linux&#39;</span></span>
<span id="cb59-6"><a href="#cb59-6" aria-hidden="true" tabindex="-1"></a>    <span class="er">}</span></span>
<span id="cb59-7"><a href="#cb59-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-8"><a href="#cb59-8" aria-hidden="true" tabindex="-1"></a>    <span class="ex">environment</span> {</span>
<span id="cb59-9"><a href="#cb59-9" aria-hidden="true" tabindex="-1"></a>        <span class="ex">TOMCAT_SERVER</span> = <span class="st">&#39;&lt;tomcat_ip&gt;&#39;</span></span>
<span id="cb59-10"><a href="#cb59-10" aria-hidden="true" tabindex="-1"></a>        <span class="ex">TOMCAT_PATH</span> = <span class="st">&#39;/opt/tomcat/webapps&#39;</span></span>
<span id="cb59-11"><a href="#cb59-11" aria-hidden="true" tabindex="-1"></a>        <span class="ex">TOMCAT_SERVER_USER</span> = <span class="st">&#39;root&#39;</span></span>
<span id="cb59-12"><a href="#cb59-12" aria-hidden="true" tabindex="-1"></a>        <span class="ex">TOMCAT_STARTUP_SCRIPT</span> = <span class="st">&#39;/opt/tomcat/bin/startup.sh&#39;</span></span>
<span id="cb59-13"><a href="#cb59-13" aria-hidden="true" tabindex="-1"></a>        <span class="ex">TOMCAT_SHUTDOWN_SCRIPT</span> = <span class="st">&#39;/opt/tomcat/bin/shutdown.sh&#39;</span></span>
<span id="cb59-14"><a href="#cb59-14" aria-hidden="true" tabindex="-1"></a>        <span class="ex">NEXUS_VERSION</span> = <span class="st">&quot;nexus3&quot;</span></span>
<span id="cb59-15"><a href="#cb59-15" aria-hidden="true" tabindex="-1"></a>        <span class="ex">NEXUS_PROTOCOL</span> = <span class="st">&quot;http&quot;</span></span>
<span id="cb59-16"><a href="#cb59-16" aria-hidden="true" tabindex="-1"></a>        <span class="ex">NEXUS_URL</span> = <span class="st">&quot;&lt;nexus_ip&gt;:&lt;port&gt;&quot;</span></span>
<span id="cb59-17"><a href="#cb59-17" aria-hidden="true" tabindex="-1"></a>        <span class="ex">NEXUS_REPOSITORY</span> = <span class="st">&quot;maven-releases&quot;</span></span>
<span id="cb59-18"><a href="#cb59-18" aria-hidden="true" tabindex="-1"></a>        <span class="ex">NEXUS_CREDENTIAL_ID</span> = <span class="st">&quot;nexus-credentials&quot;</span></span>
<span id="cb59-19"><a href="#cb59-19" aria-hidden="true" tabindex="-1"></a>    <span class="er">}</span></span>
<span id="cb59-20"><a href="#cb59-20" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb59-21"><a href="#cb59-21" aria-hidden="true" tabindex="-1"></a>    <span class="ex">tools</span> {</span>
<span id="cb59-22"><a href="#cb59-22" aria-hidden="true" tabindex="-1"></a>        <span class="ex">maven</span> <span class="st">&#39;maven 3.8.6&#39;</span></span>
<span id="cb59-23"><a href="#cb59-23" aria-hidden="true" tabindex="-1"></a>    <span class="er">}</span></span>
<span id="cb59-24"><a href="#cb59-24" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb59-25"><a href="#cb59-25" aria-hidden="true" tabindex="-1"></a>    <span class="ex">stages</span> {</span>
<span id="cb59-26"><a href="#cb59-26" aria-hidden="true" tabindex="-1"></a>        <span class="ex">stage</span><span class="er">(</span><span class="st">&#39;Checkout Code&#39;</span><span class="kw">){</span></span>
<span id="cb59-27"><a href="#cb59-27" aria-hidden="true" tabindex="-1"></a>            <span class="ex">steps{</span></span>
<span id="cb59-28"><a href="#cb59-28" aria-hidden="true" tabindex="-1"></a>                <span class="ex">checkout</span> scm</span>
<span id="cb59-29"><a href="#cb59-29" aria-hidden="true" tabindex="-1"></a>            <span class="kw">}</span></span>
<span id="cb59-30"><a href="#cb59-30" aria-hidden="true" tabindex="-1"></a>        <span class="er">}</span></span>
<span id="cb59-31"><a href="#cb59-31" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb59-32"><a href="#cb59-32" aria-hidden="true" tabindex="-1"></a>        <span class="ex">stage</span><span class="er">(</span><span class="st">&#39;Test&#39;</span><span class="kw">){</span></span>
<span id="cb59-33"><a href="#cb59-33" aria-hidden="true" tabindex="-1"></a>            <span class="ex">steps{</span></span>
<span id="cb59-34"><a href="#cb59-34" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sh</span> <span class="st">&#39;mvn test&#39;</span></span>
<span id="cb59-35"><a href="#cb59-35" aria-hidden="true" tabindex="-1"></a>            <span class="kw">}</span></span>
<span id="cb59-36"><a href="#cb59-36" aria-hidden="true" tabindex="-1"></a>        <span class="er">}</span></span>
<span id="cb59-37"><a href="#cb59-37" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb59-38"><a href="#cb59-38" aria-hidden="true" tabindex="-1"></a>        <span class="ex">stage</span><span class="er">(</span><span class="st">&#39;Build&#39;</span><span class="kw">){</span></span>
<span id="cb59-39"><a href="#cb59-39" aria-hidden="true" tabindex="-1"></a>            <span class="ex">steps{</span></span>
<span id="cb59-40"><a href="#cb59-40" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sh</span> <span class="st">&#39;mvn package&#39;</span></span>
<span id="cb59-41"><a href="#cb59-41" aria-hidden="true" tabindex="-1"></a>            <span class="kw">}</span></span>
<span id="cb59-42"><a href="#cb59-42" aria-hidden="true" tabindex="-1"></a>        <span class="er">}</span></span>
<span id="cb59-43"><a href="#cb59-43" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb59-44"><a href="#cb59-44" aria-hidden="true" tabindex="-1"></a>        <span class="ex">stage</span><span class="er">(</span><span class="st">&#39;Deploy Onayı&#39;</span><span class="kw">)</span> <span class="kw">{</span></span>
<span id="cb59-45"><a href="#cb59-45" aria-hidden="true" tabindex="-1"></a>            <span class="ex">steps</span> {</span>
<span id="cb59-46"><a href="#cb59-46" aria-hidden="true" tabindex="-1"></a>                <span class="ex">input</span> m</span>
<span id="cb59-47"><a href="#cb59-47" aria-hidden="true" tabindex="-1"></a>                <span class="ex">essage:</span> <span class="st">&#39;Uygulamayı test ortamına deploy etmek istiyor musunuz?&#39;</span>,</span>
<span id="cb59-48"><a href="#cb59-48" aria-hidden="true" tabindex="-1"></a>                      <span class="ex">ok:</span> <span class="st">&#39;Evet, Deploy Et&#39;</span></span>
<span id="cb59-49"><a href="#cb59-49" aria-hidden="true" tabindex="-1"></a>            <span class="kw">}</span></span>
<span id="cb59-50"><a href="#cb59-50" aria-hidden="true" tabindex="-1"></a>        <span class="er">}</span></span>
<span id="cb59-51"><a href="#cb59-51" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb59-52"><a href="#cb59-52" aria-hidden="true" tabindex="-1"></a>        <span class="ex">stage</span><span class="er">(</span><span class="st">&quot;Deploy on Test&quot;</span><span class="kw">)</span> <span class="kw">{</span></span>
<span id="cb59-53"><a href="#cb59-53" aria-hidden="true" tabindex="-1"></a>            <span class="ex">steps</span> {</span>
<span id="cb59-54"><a href="#cb59-54" aria-hidden="true" tabindex="-1"></a>                <span class="ex">sshagent</span><span class="er">(</span><span class="ex">[</span><span class="st">&#39;deploy-ssh-key&#39;</span><span class="ex">]</span><span class="kw">)</span> <span class="kw">{</span></span>
<span id="cb59-55"><a href="#cb59-55" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">sh</span> <span class="st">&#39;&#39;&#39;</span></span>
<span id="cb59-56"><a href="#cb59-56" aria-hidden="true" tabindex="-1"></a><span class="st">                        scp -o StrictHostKeyChecking=no target/*.war ${TOMCAT_SERVER_USER}@${TOMCAT_SERVER}:${TOMCAT_PATH}</span></span>
<span id="cb59-57"><a href="#cb59-57" aria-hidden="true" tabindex="-1"></a><span class="st">                        ssh -o StrictHostKeyChecking=no ${TOMCAT_SERVER_USER}@${TOMCAT_SERVER} &quot;sudo sh ${TOMCAT_SHUTDOWN_SCRIPT}&quot;</span></span>
<span id="cb59-58"><a href="#cb59-58" aria-hidden="true" tabindex="-1"></a><span class="st">                        ssh -o StrictHostKeyChecking=no ${TOMCAT_SERVER_USER}@${TOMCAT_SERVER} &quot;sudo sh ${TOMCAT_STARTUP_SCRIPT}&quot;</span></span>
<span id="cb59-59"><a href="#cb59-59" aria-hidden="true" tabindex="-1"></a><span class="st">                    &#39;&#39;&#39;</span></span>
<span id="cb59-60"><a href="#cb59-60" aria-hidden="true" tabindex="-1"></a>                <span class="kw">}</span></span>
<span id="cb59-61"><a href="#cb59-61" aria-hidden="true" tabindex="-1"></a>            <span class="kw">}</span></span>
<span id="cb59-62"><a href="#cb59-62" aria-hidden="true" tabindex="-1"></a>        <span class="er">}</span></span>
<span id="cb59-63"><a href="#cb59-63" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb59-64"><a href="#cb59-64" aria-hidden="true" tabindex="-1"></a>        <span class="ex">stage</span><span class="er">(</span><span class="st">&quot;Publish to Nexus&quot;</span><span class="kw">)</span> <span class="kw">{</span></span>
<span id="cb59-65"><a href="#cb59-65" aria-hidden="true" tabindex="-1"></a>            <span class="ex">steps</span> {</span>
<span id="cb59-66"><a href="#cb59-66" aria-hidden="true" tabindex="-1"></a>                <span class="ex">script</span> {</span>
<span id="cb59-67"><a href="#cb59-67" aria-hidden="true" tabindex="-1"></a>                    <span class="ex">pom</span> = readMavenPom file: <span class="st">&quot;pom.xml&quot;</span></span>
<span id="cb59-68"><a href="#cb59-68" aria-hidden="true" tabindex="-1"></a>                    <span class="ex">filesByGlob</span> = findFiles<span class="er">(</span><span class="ex">glob:</span> <span class="st">&quot;target/*.</span><span class="va">${pom</span><span class="er">.packaging</span><span class="va">}</span><span class="st">&quot;</span><span class="kw">)</span></span>
<span id="cb59-69"><a href="#cb59-69" aria-hidden="true" tabindex="-1"></a>                    <span class="ex">artifactPath</span> = filesByGlob<span class="pp">[</span><span class="ss">0</span><span class="pp">]</span>.path</span>
<span id="cb59-70"><a href="#cb59-70" aria-hidden="true" tabindex="-1"></a>                    <span class="ex">artifactExists</span> = fileExists artifactPath</span>
<span id="cb59-71"><a href="#cb59-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-72"><a href="#cb59-72" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">if</span><span class="kw">(</span><span class="ex">artifactExists</span><span class="kw">)</span> <span class="kw">{</span></span>
<span id="cb59-73"><a href="#cb59-73" aria-hidden="true" tabindex="-1"></a>                        <span class="bu">echo</span> <span class="st">&quot;*** File: </span><span class="va">${artifactPath}</span><span class="st">, group: </span><span class="va">${pom</span><span class="er">.groupId</span><span class="va">}</span><span class="st">, packaging: </span><span class="va">${pom</span><span class="er">.packaging</span><span class="va">}</span><span class="st">, version </span><span class="va">${pom</span><span class="er">.version</span><span class="va">}</span><span class="st">&quot;</span></span>
<span id="cb59-74"><a href="#cb59-74" aria-hidden="true" tabindex="-1"></a>                        </span>
<span id="cb59-75"><a href="#cb59-75" aria-hidden="true" tabindex="-1"></a>                        <span class="ex">nexusArtifactUploader</span><span class="er">(</span></span>
<span id="cb59-76"><a href="#cb59-76" aria-hidden="true" tabindex="-1"></a>                            <span class="ex">nexusVersion:</span> NEXUS_VERSION,</span>
<span id="cb59-77"><a href="#cb59-77" aria-hidden="true" tabindex="-1"></a>                            <span class="ex">protocol:</span> NEXUS_PROTOCOL,</span>
<span id="cb59-78"><a href="#cb59-78" aria-hidden="true" tabindex="-1"></a>                            <span class="ex">nexusUrl:</span> NEXUS_URL,</span>
<span id="cb59-79"><a href="#cb59-79" aria-hidden="true" tabindex="-1"></a>                            <span class="ex">groupId:</span> pom.groupId,</span>
<span id="cb59-80"><a href="#cb59-80" aria-hidden="true" tabindex="-1"></a>                            <span class="ex">version:</span> pom.version,</span>
<span id="cb59-81"><a href="#cb59-81" aria-hidden="true" tabindex="-1"></a>                            <span class="ex">repository:</span> NEXUS_REPOSITORY,</span>
<span id="cb59-82"><a href="#cb59-82" aria-hidden="true" tabindex="-1"></a>                            <span class="ex">credentialsId:</span> NEXUS_CREDENTIAL_ID,</span>
<span id="cb59-83"><a href="#cb59-83" aria-hidden="true" tabindex="-1"></a>                            <span class="ex">artifacts:</span> [</span>
<span id="cb59-84"><a href="#cb59-84" aria-hidden="true" tabindex="-1"></a>                                <span class="ex">[artifactId:</span> pom.artifactId,</span>
<span id="cb59-85"><a href="#cb59-85" aria-hidden="true" tabindex="-1"></a>                                <span class="ex">classifier:</span> <span class="st">&#39;&#39;</span>,</span>
<span id="cb59-86"><a href="#cb59-86" aria-hidden="true" tabindex="-1"></a>                                <span class="ex">file:</span> artifactPath,</span>
<span id="cb59-87"><a href="#cb59-87" aria-hidden="true" tabindex="-1"></a>                                <span class="ex">type:</span> pom.packaging],</span>
<span id="cb59-88"><a href="#cb59-88" aria-hidden="true" tabindex="-1"></a>                                <span class="ex">[artifactId:</span> pom.artifactId,</span>
<span id="cb59-89"><a href="#cb59-89" aria-hidden="true" tabindex="-1"></a>                                <span class="ex">classifier:</span> <span class="st">&#39;&#39;</span>,</span>
<span id="cb59-90"><a href="#cb59-90" aria-hidden="true" tabindex="-1"></a>                                <span class="ex">file:</span> <span class="st">&quot;pom.xml&quot;</span>,</span>
<span id="cb59-91"><a href="#cb59-91" aria-hidden="true" tabindex="-1"></a>                                <span class="ex">type:</span> <span class="st">&quot;pom&quot;</span>]</span>
<span id="cb59-92"><a href="#cb59-92" aria-hidden="true" tabindex="-1"></a>                            <span class="ex">]</span></span>
<span id="cb59-93"><a href="#cb59-93" aria-hidden="true" tabindex="-1"></a>                        <span class="kw">)</span></span>
<span id="cb59-94"><a href="#cb59-94" aria-hidden="true" tabindex="-1"></a>                    <span class="kw">}</span> <span class="cf">else</span> <span class="kw">{</span></span>
<span id="cb59-95"><a href="#cb59-95" aria-hidden="true" tabindex="-1"></a>                        <span class="ex">error</span> <span class="st">&quot;*** File: </span><span class="va">${artifactPath}</span><span class="st">, could not be found&quot;</span></span>
<span id="cb59-96"><a href="#cb59-96" aria-hidden="true" tabindex="-1"></a>                    <span class="kw">}</span></span>
<span id="cb59-97"><a href="#cb59-97" aria-hidden="true" tabindex="-1"></a>                <span class="kw">}</span></span>
<span id="cb59-98"><a href="#cb59-98" aria-hidden="true" tabindex="-1"></a>            <span class="er">}</span></span>
<span id="cb59-99"><a href="#cb59-99" aria-hidden="true" tabindex="-1"></a>        <span class="er">}</span></span>
<span id="cb59-100"><a href="#cb59-100" aria-hidden="true" tabindex="-1"></a>    <span class="er">}</span></span>
<span id="cb59-101"><a href="#cb59-101" aria-hidden="true" tabindex="-1"></a><span class="er">}</span></span></code></pre></div>
<p><strong>Pipeline’ın İşleyişi:</strong></p>
<ol type="1">
<li><strong>Checkout Code:</strong> Kaynak kodunu Git deposundan
çeker.</li>
<li><strong>Test:</strong> Maven ile testleri çalıştırır.</li>
<li><strong>Build:</strong> Maven ile projeyi paketler (WAR dosyası
oluşturur).</li>
<li><strong>Deploy Onayı:</strong> Kullanıcıdan dağıtım için onay
ister.</li>
<li><strong>Deploy on Test:</strong>
<ul>
<li><strong>sshagent([‘deploy-ssh-key’]):</strong> deploy-ssh-key adlı
SSH credential’ını kullanarak SSH bağlantısı kurar. Bu credential,
Tomcat sunucusuna bağlanmak için gerekli olan private key’i içerir.</li>
<li>**scp -o StrictHostKeyChecking=no target/*.war <span
class="math inline"><em>T</em><em>O</em><em>M</em><em>C</em><em>A</em><em>T</em><sub><em>S</em></sub><em>E</em><em>R</em><em>V</em><em>E</em><em>R</em><sub><em>U</em></sub><em>S</em><em>E</em><em>R</em>@</span>{TOMCAT_SERVER}:<span
class="math inline"><em>T</em><em>O</em><em>M</em><em>C</em><em>A</em><em>T</em><sub><em>P</em></sub><em>A</em><em>T</em><em>H</em> : * * <em>W</em><em>A</em><em>R</em><em>d</em><em>o</em><em>s</em><em>y</em><em>a</em><em>s</em><em>ı</em><em>n</em><em>ı</em><em>T</em><em>o</em><em>m</em><em>c</em><em>a</em><em>t</em><em>s</em><em>u</em><em>n</em><em>u</em><em>c</em><em>u</em><em>s</em><em>u</em><em>n</em><em>a</em><em>k</em><em>o</em><em>p</em><em>y</em><em>a</em><em>l</em><em>a</em><em>r</em>. − * * <em>s</em><em>c</em><em>p</em> : * * <em>S</em><em>S</em><em>H</em><em>ü</em><em>z</em><em>e</em><em>r</em><em>i</em><em>n</em><em>d</em><em>e</em><em>n</em><em>d</em><em>o</em><em>s</em><em>y</em><em>a</em><em>k</em><em>o</em><em>p</em><em>y</em><em>a</em><em>l</em><em>a</em><em>m</em><em>a</em><em>k</em><em>o</em><em>m</em><em>u</em><em>t</em><em>u</em>. − * * <em>o</em><em>S</em><em>t</em><em>r</em><em>i</em><em>c</em><em>t</em><em>H</em><em>o</em><em>s</em><em>t</em><em>K</em><em>e</em><em>y</em><em>C</em><em>h</em><em>e</em><em>c</em><em>k</em><em>i</em><em>n</em><em>g</em> = <em>n</em><em>o</em> : * * <em>İ</em><em>l</em><em>k</em><em>b</em><em>a</em><em>ğ</em><em>l</em><em>a</em><em>n</em><em>t</em><em>ı</em><em>d</em><em>a</em><em>h</em><em>o</em><em>s</em><em>t</em><em>k</em><em>e</em><em>y</em>′<em>i</em><em>o</em><em>t</em><em>o</em><em>m</em><em>a</em><em>t</em><em>i</em><em>k</em><em>o</em><em>l</em><em>a</em><em>r</em><em>a</em><em>k</em><em>k</em><em>a</em><em>b</em><em>u</em><em>l</em><em>e</em><em>d</em><em>e</em><em>r</em>.(<em>G</em><em>ü</em><em>v</em><em>e</em><em>n</em><em>l</em><em>i</em><em>k</em><em>a</em><em>ç</em><em>ı</em><em>s</em><em>ı</em><em>n</em><em>d</em><em>a</em><em>n</em><em>d</em><em>i</em><em>k</em><em>k</em><em>a</em><em>t</em><em>l</em><em>i</em><em>o</em><em>l</em><em>u</em><em>n</em><em>m</em><em>a</em><em>l</em><em>ı</em>, <em>g</em><em>e</em><em>r</em><em>ç</em><em>e</em><em>k</em><em>o</em><em>r</em><em>t</em><em>a</em><em>m</em><em>d</em><em>a</em><em>b</em><em>u</em><em>s</em><em>e</em><em>ç</em><em>e</em><em>n</em><em>e</em><em>k</em><em>k</em><em>a</em><em>l</em><em>d</em><em>ı</em><em>r</em><em>ı</em><em>l</em><em>a</em><em>b</em><em>i</em><em>l</em><em>i</em><em>r</em><em>v</em><em>e</em><em>y</em><em>a</em><em>d</em><em>i</em><em>k</em><em>k</em><em>a</em><em>t</em><em>l</em><em>i</em><em>b</em><em>i</em><em>r</em><em>ş</em><em>e</em><em>k</em><em>i</em><em>l</em><em>d</em><em>e</em><em>y</em><em>ö</em><em>n</em><em>e</em><em>t</em><em>i</em><em>l</em><em>m</em><em>e</em><em>l</em><em>i</em><em>d</em><em>i</em><em>r</em>). − * * <em>t</em><em>a</em><em>r</em><em>g</em><em>e</em><em>t</em>/ * .<em>w</em><em>a</em><em>r</em> : * * <em>K</em><em>o</em><em>p</em><em>y</em><em>a</em><em>l</em><em>a</em><em>n</em><em>a</em><em>c</em><em>a</em><em>k</em><em>W</em><em>A</em><em>R</em><em>d</em><em>o</em><em>s</em><em>y</em><em>a</em><em>s</em><em>ı</em><em>n</em><em>ı</em><em>n</em><em>k</em><em>o</em><em>n</em><em>u</em><em>m</em><em>u</em>. − **</span>{TOMCAT_SERVER_USER}@<span
class="math inline"><em>T</em><em>O</em><em>M</em><em>C</em><em>A</em><em>T</em><sub><em>S</em></sub><em>E</em><em>R</em><em>V</em><em>E</em><em>R</em>:</span>{TOMCAT_PATH}:** Dosyanın
kopyalanacağı hedef sunucu ve dizin.</li>
<li><strong>ssh -o StrictHostKeyChecking=no <span
class="math inline"><em>T</em><em>O</em><em>M</em><em>C</em><em>A</em><em>T</em><sub><em>S</em></sub><em>E</em><em>R</em><em>V</em><em>E</em><em>R</em><sub><em>U</em></sub><em>S</em><em>E</em><em>R</em>@</span>{TOMCAT_SERVER}
“sudo sh ${TOMCAT_SHUTDOWN_SCRIPT}”:</strong> Tomcat’i durdurur.</li>
<li><strong>ssh -o StrictHostKeyChecking=no <span
class="math inline"><em>T</em><em>O</em><em>M</em><em>C</em><em>A</em><em>T</em><sub><em>S</em></sub><em>E</em><em>R</em><em>V</em><em>E</em><em>R</em><sub><em>U</em></sub><em>S</em><em>E</em><em>R</em>@</span>{TOMCAT_SERVER}
“sudo sh ${TOMCAT_STARTUP_SCRIPT}”:</strong> Tomcat’i başlatır.</li>
</ul></li>
<li><strong>Publish to Nexus:</strong> (Opsiyonel) Üretilen artifact’ı
(WAR dosyası) Nexus’e yükler. Bu aşama, artifact’ların merkezi bir
depoda saklanmasını ve paylaşılmasını sağlar.</li>
</ol>
<p><strong>Jenkins Configuration as Code (JCasc)</strong></p>
<p>Jenkins Configuration as Code (JCasc), Jenkins ayarlarını kod olarak
yönetmenizi sağlayan bir yaklaşımdır. Bu yaklaşım, Jenkins
ayarlarını YAML formatında dosyalarda saklamanıza ve versiyon kontrol
sisteminde tutmanıza olanak tanır.</p>
<p>JCasc ile Jenkins ortamınızı kolayca yeniden oluşturabilir veya
farklı ortamlara dağıtabilirsiniz.Jenkins ayarlarını otomatik olarak
uygulayabilir ve yönetebilirsiniz.</p>
<p>Bu özelliği kullanabilmek için Jenkins’te “Configuration as Code”
plugin’ini kurun.</p>
<figure>
<img src="/image/dokuman4_ss/conf-as-code.png" alt="image" />
<figcaption aria-hidden="true">image</figcaption>
</figure>
<p><strong>Seed Jobs ve Job DSL</strong></p>
<p>Seed Jobs ve Job DSL (Domain-Specific Language), Jenkins’te job’ları
otomatik olarak oluşturmanızı sağlayan bir yaklaşımdır. Bu yaklaşım,
büyük sayıda benzer işi yönetmek ve yapılandırmayı otomatikleştirmek
için idealdir.</p>
<p><strong>Ek Notlar:</strong></p>
<ul>
<li>JCasc ve Job DSL, Jenkins’i daha ölçeklenebilir, yönetilebilir ve
sürdürülebilir hale getirmek için kullanabileceğiniz güçlü
araçlardır.</li>
<li>Bu konular, bu dokümanın kapsamı dışındadır. Ancak, daha fazla bilgi
edinmek için aşağıdaki kaynaklara başvurabilirsiniz.</li>
<li>****https://www.jenkins.io/projects/jcasc/</li>
<li><a
href="https://www.google.com/url?sa=E&amp;q=https%3A%2F%2Fwww.jenkins.io%2Fdoc%2Fpipeline%2Fsteps%2Fjob-dsl%2F"><strong>https://www.jenkins.io/doc/pipeline/steps/job-dsl/</strong></a></li>
</ul>
